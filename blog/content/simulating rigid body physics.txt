@v2

@url simulating_rigid_body_physics
@title Simulating Rigid Body Physics

@tags python, notebook, tutorial+demo

@lang en
@desc Want to know how to do a full-blown physics simulation of rigid bodies and collisions between them? In this in-depth tutorial I share the knowledge I gained from the time I wondered the same...
@keywords math, physics, notebook, visualization, rigid, body, simulation, physics engine, engine, mathematics

@content-jupyter

@index yes

@extra_html_head
<link rel="stylesheet" href="/styles/jupyter-notebook.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script type="text/x-mathjax-config">
init_mathjax = function() {
    if (window.MathJax) {
    // MathJax loaded
        MathJax.Hub.Config({
            TeX: {
                equationNumbers: {
                autoNumber: "AMS",
                useLabelIds: true
                }
            },
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true,
                processEnvironments: true
            },
            displayAlign: 'center',
            CommonHTML: {
                linebreaks: { 
                automatic: true 
                }
            }
        });
    
        MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
    }
}
init_mathjax();
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"> </script>

@end_meta




#raw

<div class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
<div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[1]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[2]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Want to know how to do a full-blown physics simulation of #note[rigid bodies](Bodies that does not deform on contact. A completely rigid body doesn't exist in real life since all bodies break under high enough pressure. For the purpose of simulation we assume they are unbreakable.) and collisions between them? In this in-depth tutorial I share the knowledge I gained from the time I wondered the same...</p>
<p>When simulating physics we show graphically the interaction between objects, trying to model real-life phenomena - mass, acceleration/velocity, forces, fluids, heat, soft/rigid bodies, etc. This is very useful and has enormous practical applications for engineering, physics, chemistry and of course for games and entertainment!</p>
<p>Here we'll explore how you can take equations of motion from physics and apply them to bodies, the math behind checking for intersecting objects, different types of collision handling. Are you up for the challenge?</p>
<p>I'll assume you have basic knowledge of Classical Mechanics though - forces, Newton's laws, torque.. so I won't take time to fully explain every detail. If you are struggling with the formulas, though, I suggest quickly looking through some materials, e.g. <a href="https://www.khanacademy.org/science/physics#forces-newtons-laws">Khan Academy</a> has a good course on Physics! :)</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#header Visualization 

<ul>
<li><p><em>At first I tried making a 60 fps interactive application in Jupyter notebook, but that, as intuition should've told me, didn't go well. I decided to use a graphics library I've been working on and just interface C++ with Python. So the resulting physics code is entirely written in Python while the graphics is sent to C++ and rendered with DirectX.</em></p>
</li>
<li><p>The demos which you can run (including the source code for the entire physics engine) is available in <a href="./Simulating-Rigid-Body-Physics.zip">the zip</a>.</p>
</li>
</ul>
<p>In case you are not on Windows, I'm very sorry I can't provide a port to you, but you can see the final result in the video below and follow along with a graphics library of your choice (<a href="https://www.pygame.org/news">PyGame</a> is a good option).</p>
<iframe width="100%" height="350px" src="https://www.youtube.com/embed/-HBv0UTiBwU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>When you extract the .zip. All of the engine's source code is available in <code>data/scripts</code>. In the scripts you'll see that we are using a custom <code>lstdgraphics</code> Python module that is built from the C++ side, and which enables us to call drawing functions:</p>

<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lstdgraphics</span> <span class="k">as</span> <span class="nn">g</span>
<span class="k">def</span> <span class="nf">frame</span><span class="p">():</span>
    <span class="n">g</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span> <span class="n">thickness</span> <span class="o">=</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
<p>I won't explain the Python to C++ and DirectX interfacing part here, just because I want the focus here to be on the physics  and math. It would be much better suited for a separate article.</p>
<p>Each demo has a main file which gets loaded by the engine. The engine searches for file names that begin with "demo_", like this: <code>data/scripts/demo_grabbing.py</code>, <code>data/scripts/demo_normals.py</code>, ...</p>
<p>Open <code>run_demos.exe</code>.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#index

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#header Shapes 

<p>The first essential thing we need to look at is shapes. Shapes represent the volume which an object occupies (2D or 3D) and can be really simple (circles) or really complex (many polygons linked together).</p>
<p>The vertices that are part of the shape of our body are in #note[local space](Each individual body has it's own virtual origin (0, 0\) in which vertices are placed relative to. This is called local space. Moving/rotating the object doesn't affect it.). We imagine the object's #note[global](The space in which all bodies get placed in when drawing is called global space (or world space\).) position to be the same as the origin of our local space and so vertices become "offsets" from that. This allows us to use 1 shape for many objects and those objects can have different positions and rotations.</p>
<p>We define the shape's space origin to be at <code>(0,0)</code>, although it's geometric center (centroid) may not lie on the origin (we later see how we can correct that).</p>
<div>
<img src="data/local-space-global-space.png" width="600"/>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>We define two kinds of shapes in the engine: circles and #ext_link[convex polygons](https://mathworld.wolfram.com/ConvexPolygon.html). Convex means that there are no angles bigger than 180 inside of the polygon - this assumption is very common in physics engines, because the calculations we do rely #note[on that being the case](Note that as a workaround, a concave shape can be represented with a bunch of convex polygons.).</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>For polygons we cache the <em>edges</em> and also their #note[normal vectors](A normal/orthogonal/perpendicular vector is a vector which forms a 90 degree angle (clockwise or counter-clockwise according to convention\) with another vector.). These are often used, so pre-calculating them makes sense. The convention we use is that the polygon's vertices are ordered <em>counter-clockwise</em>. The <code>edges</code> and <code>normals</code> arrays contain the edge/normal between vertex <code>i</code> and vertex <code>i + 1</code> in the <code>i</code>th slot.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="n">vertices</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a helper function which returns an array of edges from given vertices.</span>
<span class="sd">    e.g: [[0, 1], [1, 1], [1, 0]] </span>
<span class="sd">         -&gt; </span>
<span class="sd">         [[[0, 1], [1, 1]],</span>
<span class="sd">          [[1, 1], [1, 0]],</span>
<span class="sd">          [[1, 0], [0, 1]]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># First we make an array with the required length and shape</span>
    <span class="n">es</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    
    <span class="c1"># We save the first vertex and start iterating from 1</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># At the end this module operation cycles us back to the first vertex</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)]</span>
        
        <span class="c1"># An edge is defined by it&#39;s two vertices</span>
        <span class="n">es</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
        
        <span class="c1"># Update the previous vertex</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">es</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Let's discuss how we calculate the normals for the edges. If we have a vector <code>u = [x, y]</code>, we can rotate it 90 degrees in two ways. Clockwise or counter-clockwise. These correspond to the vectors <code>[y, -x]</code> and <code>[-y, x]</code>. To see why this is true let's plot them:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[4]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_vectors</span><span class="p">(</span><span class="n">starts</span><span class="p">,</span> <span class="n">ends</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">vectors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">starts</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ends</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        
        <span class="c1"># Transform end coords into an offset because that&#39;s what quiver() expects..</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">e</span> <span class="o">-</span> <span class="n">s</span>
        <span class="n">vectors</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">offset</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    
    <span class="n">soa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">soa</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">scale_units</span> <span class="o">=</span> <span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_vector</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
    <span class="n">plot_vectors</span><span class="p">([</span><span class="n">start</span><span class="p">],</span> <span class="p">[</span><span class="n">end</span><span class="p">],</span> <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">color</span><span class="p">])</span>
    
<span class="k">def</span> <span class="nf">plot_add_grid</span><span class="p">(</span><span class="n">ticks</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;scaled&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[5]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span>
<span class="n">plot_vectors</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="p">[[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]],</span> <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">])</span>
<span class="n">plot_add_grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Since the vertices are ordered in counter-clockwise fashion, for each edge we choose the clockwise (<code>[y, -x]</code>) vector (it points outwards from the shape) and #note[normalize it](Normalizing a vector just means dividing by its length. The resulting vector has length exactly 1 ($x^2 + y^2 = 1$\).). Here is the algorithm:</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">normals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">normalized</span><span class="p">(</span><span class="n">orthogonal</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
<div>

<img src="data/normals.png" width="600"/>
</div>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[3]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">magnitude</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the length of vector v.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">normalized</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalizes the input - returns a vector with length 1, keeps the direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">v</span> <span class="o">/</span> <span class="n">magnitude</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">orthogonal</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the clockwise perpendicular vector.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#header Bodies 

<p>Shapes were the first part in describing the bodies in our engine! However each body needs to have certain other properties. First of all, each body has a position and rotation in space.</p>

<p>This is a good place to mention that, although everything we do is in 2D, it's not much more different in 3D. (Rotation is one thing that gets very complicated in 3D though). The important thing here is to understand the basics principles of a physics simulation which are the same in 2D, 3D or whatever-D.</p>

<p>For the sake of simplicity when creating a body we specify it's shape and uniform density. Bodies with different density in different areas exist in real life but in our simulation we #note[assume it is is evenly spread out](I hope you can see how complicated you can create your engine: you can add support for mapping a non-uniform density, or you can create joints between bodies with different densities to create a large body that approximates your real-life example. However, our aim is not to create the perfect most general physics engine (because that can easily require an ungodly amount of work\).).</p>

#sub_header Model Matrix

<p>When drawing our bodies they shouldn't appear at the same place. When we talked about shapes we said that our bodies have position and rotation, and the shape's vertices get transformed. How do we do that?</p>
<p>Well probably the most convenient way is by using matrices. For 2D <em>linear transformations</em> we need 2x2 matrices. We can't describe translation in a 2x2 matrix (translation is not a linear transformation because it moves the origin).</p>
<p>But we can encode it by using a third column:</p>
$$
T = 
\begin{bmatrix} 
1 &amp; 0 &amp; v_x \\
0 &amp; 1 &amp; v_y \\
0 &amp; 0 &amp; 1 \\
\end{bmatrix}
$$<p>When multiplying by our 2D coordinates for the vertex we add a third component which is equal to one. For example if we want to multiply the vertex position $(1.4, 8)$ by our matrix, we represent it like: $(1.4, 8, 1)$ and do the dot product:</p>
$$
P = 
\begin{bmatrix} 
1.4 \\
8 \\
1 \\
\end{bmatrix}
\begin{bmatrix} 
1 &amp; 0 &amp; v_x \\
0 &amp; 1 &amp; v_y \\
0 &amp; 0 &amp; 1 \\
\end{bmatrix}
$$<p>A rotation matrix for an angle $\theta$ is represented like this:
$$
R = 
\begin{bmatrix} 
\cos(\theta) &amp; -\sin(\theta) &amp; 0 \\
\sin(\theta) &amp; \cos(\theta) &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{bmatrix}
$$</p>
<p>If you want to see how to derive this, there are great <a href="https://www.youtube.com/watch?v=NNWeu3dNFWA&amp;feature=emb_title">videos</a>/articles on the internet.</p>
<p>So our final transformation for every body is just $M = TR$. We first rotate and then we translate (remember that in computer graphics we multiply matrices right to left). A good rule of thumb is that to get the proper final transformation we SRT - scale, rotate, translate, because we usually want scaling to happen along the axis of the object and rotation about the center of the object. In our engine we don't support scaling for the sake of simplicity.</p>

#sub_header Mass 

<p>We have a shape and density. How can we calculate the mass of our object? Well, we need to find its area (volume in 3D).</p>
<p>A circle's area is really simple to find - it's just $ \pi r^2 $.</p>
<p>For polygons we're going to use the <a href="https://en.wikipedia.org/wiki/Shoelace_formula">Shoelace formula</a>. To explain the formula let's write a quick method to plot polygons in a coordinate plane.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[7]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_polygon</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">vertices</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[8]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vertices_house</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">])</span>

<span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_house</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The green dot is the origin.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The algorithm of the <em>Shoelace formula</em> is as follows: for every edge, take a look at the triangle formed by it and the origin. To find the area of that triangle we use the cross product of the vertices (we imagine the vertices as vectors from the origin). The cross product gives us the area of a parallelogram which we need to divide by two. We sum up all the areas of all these triangles and in the end we take the absolute value.</p>
<p>The negative cross products cancels out with the overlapping area and gives us just the area of the polygon. It works like magic.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[9]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_house</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">(</span><span class="n">vertices_house</span><span class="p">):</span>
    <span class="n">plot_polygon</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#noteNotice that every time the origin and the two vertices are ordered counter-clockwise - the cross product will be positive. And every time they are ordered clockwise - negative.

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[10]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">shoelace</span><span class="p">(</span><span class="n">vertices</span><span class="p">):</span>
    <span class="n">area</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">(</span><span class="n">vertices</span><span class="p">):</span>
        <span class="n">area</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">area</span>
<span class="n">shoelace</span><span class="p">(</span><span class="n">vertices_house</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[10]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>5.0</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>To test if we've implemented the algorithm correctly, let's consider a simple triangle:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[11]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vertices_triangle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_triangle</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">shoelace</span><span class="p">(</span><span class="n">vertices_triangle</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[11]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>4.5</pre>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The correct answer is indeed $4.5$ (base is $3$ and height is $3$, so $ A = \frac{3 \cdot 3}{2} = 4.5 $).</p>
<p>Now that we have methods of finding the area of our shapes, the mass of a body is simply $m = A\rho$ (area times density).</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#sub_header Centroid

<p>When we define a shape, each vertex's coordinates are relative to the origin of the local space of the body. It's going to be really nice for calculations if that origin is also the #note[centroid](center of mass) of the shape!</p>
<p>To do that we need to find the coordinates of the centroid and shift every vertex so the centroid of the shape essentially overlaps with the origin.</p>
<p>For example, here is a pentagon which has a different center of mass than the origin. The blue figure is the result after we translate each vertex by the centroid. The green dot is now both the origin of the local space and the center of mass of the shape.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[12]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span> <span class="c1"># Origin</span>

<span class="n">vertices_5gon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_5gon</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">centroid_5gon</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.56995885</span><span class="p">,</span> <span class="mf">0.2962963</span><span class="p">]</span> <span class="c1"># We know this in advance, we will see how to calculate it later!</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_5gon</span> <span class="o">-</span> <span class="n">centroid_5gon</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Finding the center of mass of a circle is simple enough. We define a circle with only its radius around the origin, so the centroid is just $(0,0)$.</p>
<p>The centroid of a triangle ABC (its barycenter) is the average of each point's coordinates:
$$ G = (\frac{x_a + x_b + x_c}{3}; \frac{y_a + y_b + y_c}{3})$$</p>
<p>You can see this is true if you add the vectors from the vertices to G and see that their sum is zero: $ \vec{GA} + \vec{GB} + \vec{GC} = 0 $</p>
<p>Regular polygons also have this property of getting the center by just taking the average of the coordinates, however that's not true for any convex polygon. The mass of a polygon is uniformly distributed over its entire surface, not only at the vertices. Note that for simple shapes, such as triangles or regular polygons, the mass being evenly distributed over the surface is equivalent to the mass being at the vertices only.</p>
<p>When calculating the centroid for a polygon we need to #note[triangulate](divide a polygon up into smaller triangles) it and take the <em>weighted</em> average of the triangle's centroids. As visualized in the figure below, the area of the triangle measures how much of the entire mass of the polygon is contained in the triangle, thus by how much the barycenter of that triangle influences the location of the centroid of the polygon.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[13]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span> <span class="c1"># Origin</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_5gon</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">(</span><span class="n">vertices_5gon</span><span class="p">):</span>
    <span class="n">plot_polygon</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
    
    <span class="c1"># The average of the x and y coordinates (the third vertex is the origin - 0,0)</span>
    <span class="n">barycenter</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">barycenter</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">barycenter</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span> <span class="c1"># Each triangle&#39;s barycenter</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centroid_5gon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centroid_5gon</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[14]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calculate_centroid</span><span class="p">(</span><span class="n">vertices</span><span class="p">):</span>
    <span class="n">centroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
    
    <span class="c1"># While going around calculating the cross product, we get the area for free, so we don&#39;t need to calculate it at the end</span>
    <span class="n">area_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">(</span><span class="n">vertices</span><span class="p">):</span>
        <span class="n">tri_area</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># The area of each triangle</span>
        <span class="n">area_sum</span> <span class="o">+=</span> <span class="n">tri_area</span>
        <span class="n">barycenter</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3</span>
        <span class="n">centroid</span> <span class="o">+=</span> <span class="n">barycenter</span> <span class="o">*</span> <span class="n">tri_area</span> <span class="c1"># Weighted barycenter</span>
        
    <span class="c1"># Divide by the area in the end (see below why this is equivalent to using the ratio of the areas)</span>
    <span class="k">return</span> <span class="n">centroid</span> <span class="o">/</span> <span class="n">area_sum</span> 

<span class="n">calculate_centroid</span><span class="p">(</span><span class="n">vertices_5gon</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[14]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>array([0.56995885, 0.2962963 ])</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>We got the right answer (which we used it earlier - <code>centroid3</code>). To verify our function works let's plot the centroid of another polygon:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[15]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vertices_6gon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">])</span> <span class="o">+</span> <span class="mf">2.5</span>

<span class="n">centroid_6gon</span> <span class="o">=</span> <span class="n">calculate_centroid</span><span class="p">(</span><span class="n">vertices_6gon</span><span class="p">)</span>

<span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_6gon</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">centroid_6gon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centroid_6gon</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The code is essentially evaluating this expression: 
$$ G = \frac{A_1}{A}G_1 + \frac{A_2}{A}G_2 + \dots + \frac{A_n}{A}G_n = \frac{G_1A_1 + G_2A_2 + \dots + G_nA_n}{A} = \frac{G_1A_1 + G_2A_2 + \dots + G_nA_n}{A} $$
where $$ A = A_1 + A_2 + \dots + A_n $$</p>
<p>and $A_n$ are the areas of the smaller triangles inside the polygon and $G_n$ are their barycenters. In the end we divide by the total area of the polygon (which equals the sum of the smaller triangles).</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#sub_header Rotational Inertia

<p>Rotational intertia is analogous to mass in that it is a measure of the resistance a body offers to torque or rotational motion. Like mass, inertia is additive and the inertia of any shape can be calculated by summing the inertia of smaller shapes that form it.</p>
<p>The inertia of a circle about a perpendicular axis passing through its center is $\frac{1}{2}mr^2$</p>
<p>The inertia of an arbitrary convex polygon does not have a fixed formula, but like mass we can compute the inertia by subdividing the polygon into triangles with a vertex at the origin and finding their inertia.</p>
<p>The inertia of a triangle with a vertex at the origin and side vectors $a$ and $b$ about a perpendicular axis passing through the origin is given by: 
$$\frac{1}{6}m(|\vec{a}|^2 + |\vec{a}|^2 + A \cdot B) $$
The derivation of this formula is non-trivial and it will not be included here for the sake of brevity :D.</p>
<p>The rotational inertia of a polygon can then be computed as follows:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[16]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rot_inertia</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">density</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># The dot product of a vector with itself gives us it&#39;s squared length!</span>
<span class="c1"># Proof for 2D vector:</span>
<span class="c1">#     a . b = ax * bx + ay * by</span>
<span class="c1">#       If a = b:</span>
<span class="c1">#     a . a = ax * ax + ay * ay = ax^2 + ay^2</span>
<span class="k">def</span> <span class="nf">sqr_magnitude</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">(</span><span class="n">vertices_6gon</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">tri_mass</span> <span class="o">=</span> <span class="n">density</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
    
    <span class="c1"># We just apply the formula, nothing interesting here :(</span>
    <span class="n">tri_inertia</span> <span class="o">=</span> <span class="n">tri_mass</span> <span class="o">*</span> <span class="p">(</span><span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span> <span class="o">/</span> <span class="mi">6</span>
    <span class="n">rot_inertia</span> <span class="o">+=</span> <span class="n">tri_inertia</span>
    
<span class="n">rot_inertia</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[16]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult" data-mime-type="text/plain">
<pre>315.3639166666666</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>We also have a special case for static (immovable) objects. Static objects don't exist in real life but in the simulation they help us build rooms with floors and ceiling that don't get affected by other bodies or gravity. We think of them as objects with infinite mass (although we represent their mass as 0 - because it works out with the formulas. When we apply an impulse for example we take into account the mass of the object and <code>impulse * 0 = 0</code>).</p>
<p>Putting all the data together looks something like this:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[17]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Shape</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="mh">0xfff00ff</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

<span class="k">class</span> <span class="nc">Circle</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="mh">0xffff00ff</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
        
<span class="k">class</span> <span class="nc">ConvexPolygon</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="mh">0xffff00ff</span><span class="p">,</span> <span class="n">recenter</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">es</span> <span class="o">=</span> <span class="n">edges</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">shoelace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centroid</span> <span class="o">=</span> <span class="n">calculate_centroid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">recenter</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vertices</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">centroid</span>

        <span class="c1"># Recalculate edges after translating the vertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">normals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">normalized</span><span class="p">(</span><span class="n">orthogonal</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[18]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Body</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">static</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rot</span> <span class="o">=</span> <span class="mf">0.0</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ang_vel</span>  <span class="o">=</span> <span class="mf">0.0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">torque</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">static</span> <span class="o">=</span> <span class="n">static</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">static</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">density</span> <span class="o">*</span> <span class="n">shape</span><span class="o">.</span><span class="n">area</span>
            
            <span class="c1"># We use inverse mass quite often (it just appears in the formulas that way).</span>
            <span class="c1"># Some physics engines don&#39;t even store raw mass..</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inv_mass</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> 
            
            <span class="c1"># Here we check the type of the shape</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">sh</span><span class="o">.</span><span class="n">Circle</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rot_inertia</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">*</span> <span class="p">(</span><span class="n">shape</span><span class="o">.</span><span class="n">radius</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">sh</span><span class="o">.</span><span class="n">ConvexPolygon</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rot_inertia</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">shape</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
                    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">tri_mass</span> <span class="o">=</span> <span class="n">density</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
                    <span class="n">tri_inertia</span> <span class="o">=</span> <span class="n">tri_mass</span> <span class="o">*</span> <span class="p">(</span><span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span> <span class="o">/</span> <span class="mi">6</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rot_inertia</span> <span class="o">+=</span> <span class="n">tri_inertia</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inv_rot_inertia</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rot_inertia</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inv_mass</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rot_inertia</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inv_rot_inertia</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

<p><strong>Big note</strong>: The above code is not exactly what we use in our demos. The reason for that is performance! For example <code>isinstance</code> is very slow in Python by nature so instead we use an enum for the shape type (makes the code a little bit longer). We also cache a model matrix and a transformed shape with each body so we don't do unnecessary computations during the time step. If you want to look at those things, take a look at the source code!</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#note This class above is not the final definition of our body by all means! We can always add more properties to our objects. For example, restitution - how much do objects bounce. Another useful thing many physics engines do is add a <code>sleep</code> property. If an object is at rest on the ground for example, we set it's <code>sleep</code> to true and skip calculations in our time step. This can lead to huge performance gains depending on the situation. For the sake of simplicity we will not be implementing such a system.

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#header Forces and Impulses 

<p>The main interaction mechanism with a body is going to be through forces (and indirectly torque). All forces are applied per time step. That's how forces in our universe work too! (If we imagine that the time steps in real life are infinetely small). We say a force is continuous as long as it's acting on a object. If we want a continuous force to act on an object in our engine, we apply it every frame until we want it to stop.</p>
<p>The definition of torque is: $ \vec{\tau} = \vec{r} \times \vec{F} $. That means that if a force is applied at the center of mass, the torque generated is zero. If we apply it anywhere else though, we need to find the cross product - where $\vec{r}$ is the vector from the center to the point where the force is applied.</p>
<p>Impulses are large forces applied over very short periods. However, we will consider them as momentum changes and directly modify the linear and angular velocities:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[19]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">apply_force</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">force</span><span class="p">,</span> <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
    <span class="n">body</span><span class="o">.</span><span class="n">force</span> <span class="o">+=</span> <span class="n">force</span>
    <span class="n">body</span><span class="o">.</span><span class="n">torque</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">apply_impulse</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">impulse</span><span class="p">,</span> <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
    <span class="n">body</span><span class="o">.</span><span class="n">vel</span> <span class="o">+=</span> <span class="n">impulse</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">body</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span>
    <span class="n">body</span><span class="o">.</span><span class="n">ang_vel</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">impulse</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">body</span><span class="o">.</span><span class="n">rot_inertia</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>There is no point in applying forces if we are not going to use them. At the end of each time step we need to do some integration. I assume you know that we think of velocity as a derivative of position. That means that velocity describes the rate of which position changes. Acceleration is the second derivative - it describes the rate at which velocity changes.</p>
<p>Since we are dealing with computers, we need to do numerical integration. We do that by considering very small time intervals for each step. Each frame (if running at 60 fps) takes $\frac{1}{60}$ seconds or a delta time of about $0.016$.</p>
<p>Furthermore, Newton's equation of motion gives a way to relate forces and acceleration.
$$\vec{F} = m\vec{a}$$
$$\vec{a} = \frac{\vec{F}}{m}$$</p>
<p>With all of this we arive at this code which applies movement to each body at the end of the frame:</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bodies</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">static</span><span class="p">:</span> <span class="k">continue</span>

    <span class="c1"># Here we also apply &#39;- up * gravity&#39; to each body (9.8 m/s^2 by default) </span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">force</span> <span class="o">/</span> <span class="n">b</span><span class="o">.</span><span class="n">mass</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">gravity</span>
    <span class="n">b</span><span class="o">.</span><span class="n">vel</span> <span class="o">+=</span> <span class="n">acc</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">b</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="n">b</span><span class="o">.</span><span class="n">vel</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c1"># Integrating angular velocity is analogous to linear velocity.</span>
    <span class="n">ang_acc</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">torque</span> <span class="o">/</span> <span class="n">b</span><span class="o">.</span><span class="n">rot_inertia</span>
    <span class="n">b</span><span class="o">.</span><span class="n">ang_vel</span> <span class="o">+=</span> <span class="n">ang_acc</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">b</span><span class="o">.</span><span class="n">rot</span> <span class="o">+=</span> <span class="n">b</span><span class="o">.</span><span class="n">ang_vel</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c1"># We also reset the force and torque at the end (as we discussed above).</span>
    <span class="n">b</span><span class="o">.</span><span class="n">force</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
    <span class="n">b</span><span class="o">.</span><span class="n">torque</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">


#sub_header Using Forces in a Demo 

<p>Now that we have a way to apply forces. Let's test it with something.. fun? (if you can call it that).
We want to make a demo where you can grab objects with your mouse and throw them around.</p>
<p>Getting information about mouse input is handled by C++ and passed to us by functions:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mouse_click</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rightButton</span><span class="p">):</span> <span class="k">pass</span>
<span class="k">def</span> <span class="nf">mouse_release</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rightButton</span><span class="p">):</span> <span class="k">pass</span>
<span class="k">def</span> <span class="nf">mouse_move</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
<p>The coordinates have been automatically converted to world space.</p>

#sub_sub_header Point vs. Shape Intersection 

<p>Here comes the first challenge. How do we determine whether we clicked a body?
We need a way to determine if a point is inside a shape.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[20]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">()</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.7</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The circle case is trivial. Just check if the vector from the center to the point has a #note[magnitude](length of a vector) less than the radius. Here only the green segment has length less than the radius, so it is inside.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[21]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">point_in_circle</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">-</span> <span class="n">center</span>
    <span class="k">return</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">radius</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>A simple optimization is to use the square length and square radius in order to avoid calculating square roots.
Here we can see the result:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[22]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">()</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.7</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span> <span class="k">if</span> <span class="n">point_in_circle</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;r&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>This #ext_link[Ray casting algorithm](https://en.wikipedia.org/wiki/Point_in_polygon) is one really clever algorithm to determine if a point is inside a polygon. You test how many times a ray, starting from the point and going in any fixed direction, intersects the edges of the polygon. If the point is on the outside of the polygon the ray will intersect its edge an even number of times. If the point is on the inside of the polygon then it will intersect the edge an odd number of times.</p>
<p><img src="data/point-in-polygon.png" width="700"/></p>
<p>If even works both for convex and concave polygons!</p>
<p>This works on theory, but in our case - not so much. I had a lot of trouble with edge cases. After implementing it I tested it thoroughly and it didn't work properly when we looked at a point on the same y-level as a vertex. I tried a lot of work-around and different implementations but none of them worked...</p>
<p>We will take a look at the implementation either way just in case you are curious :)</p>
<p>The first step is determining the intersection point of two lines.
There are quick and elegant solutions on stackoverflow using <code>np.linalg</code> but you can think about this problem on your own - you don't need fancy linear algebra. First, use the points to get the coefficients of the line equation:
$$ y = ax + b $$</p>
$$ a = \frac{\text{rise}}{\text{run}} = \frac{y_2 - y_1}{x_2 - x_1}$$<p>After we know $a$:
$$ b = y - ax $$</p>
<p>Now that we know the coefficients, just set them equal and solve for x:</p>
$$ a_1x + b_1 = a_2x + b_2 $$<p></p>
$$ a_1x - a_2x = b_2 - b_1 $$$$ x_p = \frac{b_2 - b_1}{a_1 - a_2} $$<p>And then get the y coordinate by using either equation:</p>
$$ y_p = a_1x_p + b_1 = a_2x_p + b_2 $$<p></p>
<p>We also need to handle the special case for vertical lines (where $x_2 - x_1$ is $0$).</p>
<p>Let's implement this:</p>
<div class="highlight"><pre><span></span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">run1</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">run2</span> <span class="o">=</span> <span class="n">w2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">w1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
<p>Now that we have calculated the runs of the two equations, let's check if either are $0$:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">run1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">run2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">return</span> <span class="kc">None</span> <span class="c1"># The lines are vertical and parallel</span>
</pre></div>
<p>If could also be that just one of the lines is vertical and there is a solution:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">run1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">w1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">run2</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">w2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
    <span class="c1"># y = a2 * x + b2   =&gt;   b2 = y - a2 * x</span>
    <span class="c1"># The first equation is x = p1[0]</span>
    <span class="c1"># The second equation is y = a2 * x + b2</span>
    <span class="c1"># Their intersection is at guaranteed to be at: x = p1[0]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b2</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
</pre></div>
<p>(The other case for <code>run2</code> is analogous.)</p>
<div class="highlight"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">run1</span>
<span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">w1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">run2</span>

<span class="k">if</span> <span class="n">a1</span> <span class="o">==</span> <span class="n">a2</span><span class="p">:</span>
    <span class="k">return</span> <span class="kc">None</span> <span class="c1"># The lines are horizontal and parallel</span>
</pre></div>
<p>If both lines have the same $a$ coefficient, they are either on top of each other or not intersecting. In both cases we say they don't have an intersection point.</p>
<p>Finally, we calculate the $b$ coefficients and return the intersection point:</p>
<div class="highlight"><pre><span></span><span class="n">b1</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">b2</span> <span class="o">=</span> <span class="n">w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">w2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Here we have: a1 * x + b1 = a2 * x + b2</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">b2</span> <span class="o">-</span> <span class="n">b1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a1</span> <span class="o">-</span> <span class="n">a2</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b1</span>
<span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
</pre></div>
<p>The entire algorithm:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[23]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">line_vs_line</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the intersection point of two lines.</span>
<span class="sd">    A line is represented by two points: [[p1_x, p1_y], [p2_x, p2_y]].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">line2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">run1</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">run2</span> <span class="o">=</span> <span class="n">w2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">w1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">run1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">run2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span> <span class="c1"># The lines are vertical and parallel</span>
    <span class="k">if</span> <span class="n">run1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">w1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">run2</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">w2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># y = a2 * x + b2 =&gt; b2 = y - a2 * x</span>
        <span class="c1"># The first equation is x = p1[0]</span>
        <span class="c1"># The second equation is y = a2 * x + b2</span>
        <span class="c1"># Their intersection is at guaranteed to be at: x = p1[0]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b2</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">run2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">run1</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">w1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b1</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
    
    <span class="n">a1</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">run1</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">w1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">run2</span>

    <span class="k">if</span> <span class="n">a1</span> <span class="o">==</span> <span class="n">a2</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span> <span class="c1"># The lines are horizontal and parallel</span>
    
    <span class="n">b1</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">w2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">w2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Here we have: a1 * x + b1 = a2 * x + b2</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">b2</span> <span class="o">-</span> <span class="n">b1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a1</span> <span class="o">-</span> <span class="n">a2</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b1</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Here we try a line vs all extended segments of a polygon:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[24]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">()</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_5gon</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="c1"># The point which we want to test</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">(</span><span class="n">vertices_5gon</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">line_vs_line</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The next steps are checking if the point actually lies on the segment (not the intersection) and if it actually lies on the ray (not its extension). These are really simple - just number comparisons.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[25]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_between</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if c is between a and b</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">:</span> 
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> 
    <span class="k">return</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">is_point_on_ray_extension</span><span class="p">(</span><span class="n">ray</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the point k lies on the extension of the ray (the part of the line that isn&#39;t on top of the ray).</span>
<span class="sd">    A ray is represented by a point and a relative direction: [[px, py], [dir_x, dir_y]].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get two points which represent the line that contains the ray</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">ray</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">ray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">is_between</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="n">is_between</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[26]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">ray_vs_segment</span><span class="p">(</span><span class="n">ray</span><span class="p">,</span> <span class="n">segment</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the point at which a ray and a segment intersect (or None if they don&#39;t).</span>
<span class="sd">    This doesn&#39;t pay attention to the ends of the segment.</span>
<span class="sd">    A ray is represented by a point and a relative direction: [[px, py], [dir_x, dir_y]].</span>
<span class="sd">    A segment is represented by two end points: [[p1_x, p1_y], [p2_x, p2_y]].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># First we get the intersection with the extended line.</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">ray</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">line_vs_line</span><span class="p">([</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">d</span><span class="p">],</span> <span class="n">segment</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">k</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">is_point_on_ray_extension</span><span class="p">(</span><span class="n">ray</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> <span class="c1"># We disregard the point if it doesn&#39;t lie on the ray</span>
        <span class="k">return</span> <span class="kc">None</span>
    
    <span class="c1"># Now we check for both ends of the segment</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">segment</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">segment</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">min_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">max_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">less</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">min_x</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">min_x</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">max_x</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">max_x</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">min_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">max_y</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">less</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">min_y</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">min_y</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">max_y</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">max_y</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">k</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[27]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">point_in_polygon_ray_cast</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">vertices</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns whether a point is inside a given convex polygon (p is in local space).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    
    <span class="c1"># We use a ray with a fixed direction (to the right).</span>
    <span class="n">ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
    
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">es</span> <span class="o">=</span> <span class="n">edges</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">es</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">ray_vs_segment</span><span class="p">(</span><span class="n">ray</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            
    <span class="c1"># Since ray_vs_segment doesn&#39;t pay attention to segment ends, </span>
    <span class="c1"># we also count each time the ray passes through a vertex as an edge crossed.</span>
    <span class="c1"># Note that this still isn&#39;t perfect as we will see below.</span>
    <span class="c1"># I really tried a bunch of solutions before trying the vertices but most of them were even less accurate.</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Now we generate A LOT of points around the polygon and color the ones that pass the test orange and the one that are supposed to be outside - purple:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[28]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">()</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_5gon</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">while</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
        <span class="n">in_poly</span> <span class="o">=</span> <span class="n">point_in_polygon_ray_cast</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">vertices_5gon</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span> <span class="k">if</span> <span class="n">in_poly</span> <span class="k">else</span> <span class="s2">&quot;purple&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">-=</span> <span class="mf">0.1</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="mf">0.1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[29]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">()</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_5gon</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>As you can see, there are some points which are clearly outside but pass the test. Adding cases, rethinking everything, extending the segments just by a little bit - nothing worked and there were still some false positives.</p>
<p>After giving up on this algorithm I came up with my own method. If you rememeber earlier when we calculated the area of a polygon by summing up the cross product of the vectors from the origin to the ends of each edge. We can use that here. That method of finding the area relied that sometimes the area of these triangles was positive and sometimes "negative".</p>
<p>Our vertices are ordered <em>counter-clockwise</em>. So if a point is inside a polygon, going through every edge, the area will always be <em>positive</em> (it will always be negative if the vertices were clockwise).</p>
<p>So our test simply becomes:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[30]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">point_in_polygon_cross_product</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">vertices</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns whether a point is inside a given convex polygon (p is in local space).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">es</span> <span class="o">=</span> <span class="n">edges</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">es</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">es</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span>
    
    <span class="c1"># Returns False if at least one cross product is negative (or 0)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[31]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">()</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices_5gon</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">while</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
        <span class="n">in_poly</span> <span class="o">=</span> <span class="n">point_in_polygon_cross_product</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">vertices_5gon</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;orange&quot;</span> <span class="k">if</span> <span class="n">in_poly</span> <span class="k">else</span> <span class="s2">&quot;purple&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">c</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">-=</span> <span class="mf">0.1</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="mf">0.1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>As you can see it works a lot better! :D</p>
<p>I didn't find this algorithm anywhere when searching for point vs polygon tests so I thought maybe it was too slow and nobody used it (I know I'm not the first one to come up with it).</p>
<p>So let's do some performance tests and see how bad it is compared to the previous (slightly inaccurate) one. We will again consider a large amount of points and measure both algorithms.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[32]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>

<span class="n">tests</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">time_ray_cast</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">time_cross_product</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">while</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>    
    <span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">in_poly</span> <span class="o">=</span> <span class="n">point_in_polygon_ray_cast</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">vertices_5gon</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">-=</span> <span class="mf">0.1</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">time_ray_cast</span> <span class="o">+=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">begin</span>
    
    <span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">in_poly</span> <span class="o">=</span> <span class="n">point_in_polygon_cross_product</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">vertices_5gon</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">-=</span> <span class="mf">0.1</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">time_cross_product</span> <span class="o">+=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">begin</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="mf">0.1</span>
    
    <span class="n">tests</span> <span class="o">+=</span> <span class="mi">1</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ray cast average:      &quot;</span><span class="p">,</span> <span class="n">time_ray_cast</span> <span class="o">/</span> <span class="n">tests</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cross product average: &quot;</span><span class="p">,</span> <span class="n">time_cross_product</span> <span class="o">/</span> <span class="n">tests</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output" data-mime-type="text/plain">
<pre>Ray cast average:       0.025290234883626302 s
Cross product average:  0.005345704820421007 s
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>WAIT...</p>
<p>It's even faster?</p>
<p>Well even if it was slower I was still going to use it since it's more accurate, but that's a nice surprise :D</p>
<p>I'm sure this is not a fair comparison.. after all I am using numpy vectorization while the first one I'm not so sure how to optimize.</p>
<p>Now before ditching the first algorithm all together, it did provide us with a few useful functions - testing for intersection between rays, lines and segments, etc.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#sub_sub_header Grabbing Bodies with the Mouse 

<p>When we click on the screen we need to check every body and see if any contain the mouse.</p>
<ul>
<li><em>We need to search through every body and if there are thousands of bodies this can get really slow. There are many optimization tricks for those scenarios but we won't bother since it's not a problem for now.</em></li>
</ul>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mouse_click</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rightButton</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bodies</span><span class="p">:</span>
        <span class="n">mouse_in_local_space</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">inv_model_mat</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">mouse</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">point_in_shape</span><span class="p">(</span><span class="n">mouse_in_local_space</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
            <span class="c1"># ... #</span>
            <span class="k">break</span> <span class="c1"># Don&#39;t need to check the rest of the bodies</span>
</pre></div>
<p>Where <code>point_in_shape</code> is a helper function which calls the functions we already defined:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">point_in_shape</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">Circle</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">point_in_circle</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">ConvexPolygon</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">point_in_polygon</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</pre></div>
<p>Now we need to store information about the body which was grabbed:</p>
<div class="highlight"><pre><span></span><span class="n">grabbed</span> <span class="o">=</span> <span class="n">b</span>
<span class="n">grabbed_offset</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mouse</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">pos</span>
<span class="n">grabbed_was_static</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">static</span>

<span class="c1"># We null all forces and stop moving the object while grabbing it</span>
<span class="n">set_static</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
<p>We use <code>grabbed_offset</code> as our pivot while moving the mouse. Otherwise the body's center will get teleported to the cursor instead of the part where we clicked initially.</p>
<p>When we move the mouse we save the current and the last's frame position (you will see later why) and teleport the body:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mouse_move</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">mouse_last</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mouse</span>
    <span class="n">mouse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">grabbed</span><span class="p">:</span>
        <span class="n">grabbed</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mouse</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">grabbed_offset</span>
</pre></div>
<p>When we release the mouse button we launch the body with a force!
The force direction is calculated using the last two mouse positions (which means that the faster you move the mouse, the further you launch the body):</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mouse_release</span><span class="p">(</span><span class="n">rightButton</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">grabbed</span><span class="p">:</span>
        <span class="c1"># Since the distance between 2 frames of mouse movement </span>
        <span class="c1"># is quite small let&#39;s multiply it by a large factor.</span>
        <span class="n">F</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mouse</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mouse_last</span><span class="p">))</span> <span class="o">*</span> <span class="mi">5000</span>

        <span class="n">apply_force</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">grabbed</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">grabbed_offset</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">grabbed</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
<p>You can play with the demo by selecting <code>demo_grabbing.py</code> after running the .exe.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#sub_sub_header Air Drag

<p>If you play around with the demo you will see that the object feels like they it is in space. That's because we don't simulate air drag. In the real life air drag depends on the shape, surface area of an object, etc.</p>
<p>For simplicity we can just reduce the velocity by a little bit if going slow and a lot if going fast ($1\frac{m}{s}$) and not more than that.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clamp_magnitude</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a copy of v but with length clamped.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">sq_m</span> <span class="o">=</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sq_m</span> <span class="o">&lt;</span> <span class="n">length</span> <span class="o">**</span> <span class="mi">2</span><span class="p">:</span> <span class="k">return</span> <span class="n">v</span>
    <span class="k">return</span> <span class="n">v</span> <span class="o">*</span> <span class="n">length</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sq_m</span><span class="p">)</span>
</pre></div>
<p>We apply it in the loop after we integrate acceleration and velocity:</p>
<div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">vel</span> <span class="o">-=</span> <span class="n">clamp_magnitude</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">vel</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">drag</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">b</span><span class="o">.</span><span class="n">ang_vel</span> <span class="o">-=</span> <span class="n">clamp_magnitude</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">ang_vel</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">drag</span> <span class="o">*</span> <span class="n">dt</span>
</pre></div>
<p>Where <code>drag</code> is a global constant (like <code>gravity</code>) between 0 and 1.</p>
<p>You may also notice that the floor has "collision". Yeah.. we simply check if the triangle is below the rectangle and if it is, we bring it back up and reset it's y velocity:</p>
<div class="highlight"><pre><span></span><span class="n">floor_y</span> <span class="o">=</span> <span class="n">floor</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">if</span> <span class="n">triangle</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">floor_y</span><span class="p">:</span>
    <span class="n">triangle</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">floor_y</span>
    <span class="n">triangle</span><span class="o">.</span><span class="n">vel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
<p>We shall have something more sophisticated after the next section :D.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#header Discrete Collision Detection

<p>Bodies that fly around with some force, completely ignoring each other, is cool and all, but let's take things a step further. We will detect if any two bodies <em>intersect</em> and if they do, we'll apply some type of <em>collision response</em>.</p>
<p>That's what we need to do! First figure out if two bodies intersect (and preferably by how much) and then somehow separate them.</p>

#sub_header Intersection 

<p>We have two types of shapes: circles and convex polygons. Let's look at each case for intersection:</p>

#sub_sub_header Circle vs. Circle 

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[33]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">()</span>

<span class="c1"># Set up centers and radii</span>
<span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The way we go about is by using the distance between the centers and compare it to the sum of their radii. We don't even have to get the square root, we can compare the squares (because $ x &gt; y $ if and only if $ x^2 &gt; y^2 $).</p>
<p>First we get the vector which points from the center of the first to the center of the second. That's the line which connects them.</p>
<div class="highlight"><pre><span></span><span class="n">a_to_b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">if</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">a_to_b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">r</span> <span class="o">**</span> <span class="mi">2</span><span class="p">:</span>
    <span class="c1"># The distance is larger, they definitely don&#39;t intersect</span>
</pre></div>
<p>If the comparison fails then they are colliding. Now we get the real distance and return the #note[vector of minimum translation](The vector with the least magnitude that is required to separate two overlapping shapes.).</p>
<div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">magnitude</span><span class="p">(</span><span class="n">a_to_b</span><span class="p">)</span>
<span class="k">return</span> <span class="n">a_to_b</span> <span class="o">/</span> <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
<p>The amount we have to move is just the difference between the distance and the sum of the radii.</p>
<p>One small problem though: we missed the case where the centers overlap. It's a rare case but when it happens the program crashes because we try to divide by zero. In that case without further information we can't return a direction of which the circles should move away. So we just choose arbitrarily - to the right.</p>
<p>Here is the final algorithm:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[34]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">circle_vs_circle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the minimum translation vector between two circles. None if they don&#39;t intersect.</span>
<span class="sd">    A circle is defined by a center and a radius: [[px, py], r].</span>
<span class="sd">    The vector returned points from a to b. So b is the circle that &quot;should be moved&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a_to_b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">a_to_b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">r</span> <span class="o">**</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span> <span class="c1"># The circles don&#39;t overlap</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">magnitude</span><span class="p">(</span><span class="n">a_to_b</span><span class="p">)</span>
    
    <span class="c1"># We can&#39;t compare floating numbers for equality reliably, so we use a function which checks if they are really close.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a_to_b</span> <span class="o">/</span> <span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># The amount of which we move here is just the bigger radius</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[35]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span>

<span class="n">plot_add_grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">mtv</span> <span class="o">=</span> <span class="n">circle_vs_circle</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">r1</span><span class="p">],</span> <span class="p">[</span><span class="n">c2</span><span class="p">,</span> <span class="n">r2</span><span class="p">])</span>
<span class="n">plot_vector</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">c2</span> <span class="o">+</span> <span class="n">mtv</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Cool! We draw the vector from the center of the second circle. If you want to later move first circle instead you need to negate the vector:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[36]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span>

<span class="n">mtv</span> <span class="o">=</span> <span class="n">circle_vs_circle</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">r1</span><span class="p">],</span> <span class="p">[</span><span class="n">c2</span><span class="p">,</span> <span class="n">r2</span><span class="p">])</span>

<span class="n">plot_add_grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">c2</span> <span class="o">+</span> <span class="n">mtv</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">mtv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">mtv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">plot_vector</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">c2</span> <span class="o">+</span> <span class="n">mtv</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAD8CAYAAACYVXqwAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/d3fzzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAk+ElEQVR4nO3deXgURf7H8XflgJADEAmQcASQQxAPTEQwiERBUCEgiKIo6C7CKq64+1sXFVnBFd3FW3dREVgQUYyiAqKyoAmiIkeQUw4RFoGEU65w5arfH5VgQEgmmZ7UzPT39Tz9JJP09Hxy9Hequ6urlNYaIYQ7hdgOIISwRwqAEC4mBUAIF5MCIISLSQEQwsWkAAjhYl4XAKVUhFJqqVJqlVJqnVJqjBPBhBC+p7ztB6CUUkCU1jpHKRUOfA0M11p/50RAIYTvhHm7AW0qSE7Rw/CiRXoXCREAvC4AAEqpUCATaAb8W2u95CzrDAGGAERERCQ2atTIiZd2RGFhISEh/nM6xN/ygP9lqmgerTW5hbkU6kKqhFYhVIVazVOa/MJ88grzCFEhVAmtgkJ5/NxNmzbt01rHlrmi1tqxBagJpANtSluvRYsW2p+kp6fbjnAaf8ujtf9lKm+evII8Pfarsbr2uNr61SWv6tz8XKt5PHU877ge9/U4ff4/z9cvLX5JFxQWePQ8YLn2YJ91tGRprQ8CGUB3J7crhDfW7llL+4ntyfhfBplDMnmg3QOEh4bbjuWRiLAIHk5+mMW/X8z7P7xP5ymd2fzLZse278RVgFilVM2iz6sBXYAN3m5XCCe8vfptUqamMDRxKPPunEejGv5z6Fkezc9vzsK7F9K3VV86TOrAxxs+dmS7TpwDiAOmFp0HCAHStNafOLBdISqsoLCAR794lJnrZ5I+KJ02ddrYjuS10JBQhrcfzlUNr6JPWh/W7lnLyKtHYi7EVYwTVwFWA2293Y4QTjl88jC3z7yd43nHWTp4KedHnm87kqOuqH8FSwcv5eb3bmbNnjVM6TWFauHVKrQt/zmtK4QDDhw/QNdpXakfU595d84Lup2/WFxMHBl3Z6BQ9Hi3B0dzj1ZoO1IARNA4eOIgXad15aoGV/FGjzcC5kRfRUWERTC9z3QSaiRw4zs3VqgISAEQQeHIySPcMP0GOjbqyAvdXvDquDiQhIaEMjF1Ik3Pa0qvGb04kX+iXM+XAiACXqEuZMCHA2hduzUvdnvRNTt/sRAVwsSeEzmv2nncO+fe4j45nj3Xh7mEqBSjvhzFwRMHea3Ha67b+YuFhoQytfdU1u1Zx/OLn/f4eY50BRbClhlrZzB9zXSW3buMKqFVbMexKjI8ko/7f0z7ie09fo60AETA2rR/E3/87I/M6j+L2Kiyu727QaMajXi/3/sery8FQASse2bdw6hOo7i03qW2o/iV5EbJHq8rBUAEpN1HdxMWEsYD7R6wHSWgSQEQAefH/T+yK2cXk1MnE6LkX9gb8tsTAWfEghHUjarLBbUusB0l4EkBEAHlux3fsSxrGXWj6tqOEhSkAIiAobXmkQWPMPqa0a693u80KQAiYMzfMp/dR3cz6LJBtqMEDSkAImC8vORl/nrVXwkLkf5rTpECIALC1gNbWbJjCbe1uc12lKAiBUAEhDcy32DQpYOIDI+0HSWoSFtK+L28gjwmfz+Zb373je0oQUdaAMLvLfp5EQk1E2h+fnPbUYKOFADh92ZvnE1qi1TbMYKSFADh17TWpgC0lALgC1IAhF/bsG8DBbqAS+peYjtKUJICIPza4h2LubrR1dLzz0ekAAi/lpmVSWJcou0YQUsKgPBry7OXkxgvBcBXpAAIv5VXkMfaPWtpW08mnvIVKQDCb2UdyeK8iPOIqRpjO0rQcmJ24IZKqXSl1Hql1Dql1HAnggmRnZNNfEy87RhBzYmuwPnA/2mtVyilYoBMpdR8rfUPDmxbuFjWkSwpAD7mdQtAa52ttV5R9PkRYD1Q39vtCpF9JJu46DjbMco0fc101uxZQ8iYEBq/1Jjpa6bbjuQxR28GUko1xkwVvsTJ7YoS9u2DrVshO9ssWVmnf37kCOTn/7qEhkJ4OISFQVQUxMWZJT7+9M8TEqBePds/3Wn2H9/v97P7Tl8znSFzhvBkkyfRaLYd2saQOUMAGHDxAMvpyqbKM49YqRtSKhpYCIzVWn94lu8PAYYAxMbGJqalpTnyuk7IyckhOjradoxTTuXJz4djx8xy9Kj5WFAAVauanbrkUqWK+RgaCsWdZpSC4r+v1ua5eXm/XXJzzaIUREaaQhEZaZbw8NMzVaKsI1kopc7aCvCXv9maPWvILcilQdUG7Di549TXq4RW4eI6F1vLlZKSkqm1TiprPUcKgFIqHPgEmKe1fqGs9Vu2bKk3btzo9es6JSMjg86dO9uOAQcPwmefkXHiBJ1Hj4ZDh+DyyyExEZKSzMemTSHEBxdvtIaff4blyyEz89elShXo0IGMO+6g89VXQ506zr/2OYz8YiTVwqvxeKfHf/M9f/mbhYwJgUJ4pckrjFw9ksM1DgOgUBQ+UWgtl1LKowLg9SGAMn00JwHrPdn5xRm2bIHZs2HOHFi2DDp3hoED4YsvfLezn41S5jAgIQH69jVfKy4KCxeaYtSiBVx0EaSmmuXCC39tbfhAWEgYBYUFPtu+tw7+7yCpi1NpvKQxkWMjOVz98KnvNarRyGIyzznx35UM3AVcq5RaWbTc6MB2g9fu3fD009CmDVx1FaxdC8OHw65dphjUrg3NmlXezn8uxUVh4EBTjHbvhieegO3boVs3aN4cRo40RcIHqoRWKfd8976WdzyP1dNX81aXt3i5ycu0ndeWEEI4WOMgFNXCyPBIxl431mpOT3ndAtBaf82pH12ck9bwzTcwfjx89hnccgu8+SZceaX9Hd1TVavC9deb5dVXYeVKmDIF2raFjh1h2DDo0sWxn6dOVB22HNjiyLaccHjnYd7t8S67Vu469TUVomj9UmuOhx9HoWhUoxFjrxsbECcAQYYE870jR2D6dLPjnzwJ999vPq9Z03Yy7yhldvy2bU1r5p134K9/NScr77sP7r4batXy6iXiY+LJyslyJq8DqtevTqdRnXi/3/voQnPurNOoTnQe1JmMjAwKb7V3zF9RAfLWE4COHjU7RpMmMH8+vPgibNhgmvqBvvOfKSoK7r0Xvv8e3nrLfGzWDB59FA4cqPBm42LiyD6S7WDQiivML2TBowtI65tGVJ0ooupE0TC5IZ0e72Q7mlekADgtLw9ee80cH69eDYsXw8yZcN11Pj1h5heUgg4dYNo087Pv3WtOHI4bB8ePl3tz8THx7Di8o+wVfSxndw7Tuk7jm398Q+POjRn6/VBa9m5Jn+l9CAkL7F0osNP7k8JCmDEDWrWCjz82Z/VnzDCFwI0aNICJE2HRIliyxPwe3nzT9G3wUN2ouhTqQnbl7Cp7ZR/Ztmgbb7R9g/9l/I/kR5K5a/5dRNeLpvuL3amZUNNaLqdIAXDC0qXmOv0LL8CECTBvnrlmL8ylwpkz4cMP4d13zWXEBQs8eqpSisvjLiczK9PHIX9La823z3/L1JSp5B3Lo/+s/nR5psupd/zwyPBKz+QLUgC8ceIEPPKIuSb+l7+Yd7prr7Wdyj+1a2f6NrzwAvzudzB0KBw+XObTkuKTyMyu3AJw4tAJ0vqmMf8v86l7SV2GrhhKy9SWlZqhskgBqKilS00vvc2bzfHuHXcE/zG+t5SCm26CNWvMIdMll5TZGkiMS6zUArBr1S7eTHqTDR9toO3gtvz+299zXtPzKu31K5sUgPIq+a4/ejR88EGldo8NCjVqmPMBb7xRZmugY6OOfLXtK3ILcn0ea+WUlUxqP4nDOw7T6z+9SH0zlbCI4L5SLgWgPNavN8f2xe/6t95qO1Fg69bt9NbAkt/eRBoXE0fzWs1ZtG2Rz2Lkn8hn9r2zmXXPLKo3qM7vv/s9l919mc9ez59IAfDUJ5/ANdeYY/3335d3facUtwZeeQV69jT9CM6Q2jKVOZvm+OTlD2w5wKSrJvH9xO+58OYLuXf5vdS71L9ui/YlKQBl0Rr++U/TTJ09G+65R471fSE1FTIy4Mkn4eGHza3Lxd9qmcqsjbNw6tb1YhvnbGRC4gR2r95N1+e6cuvMW4moEeHoa/g7KQClOX4c7rzTvOMvWQLt29tOFNxatzYnV7//Hnr0MLdHAxfXuZiIsAgW/ezMYUBxr74ZqTMIqxbGoPRBXPV/V7ly8hEpAOeycyd0KurmuWiR6dgifK9WLfj8c9OD8MorYeNGlFLcn3Q/45eN93rzObvO6NW3YigJVyc4EDwwSQE4m82bITkZ+vSBt9+GatVsJ3KXsDB4+WVzKHDNNbBiBQMvHci8n+Z51Stw26JtvHH5b3v1uZkUgDNt2AApKfDYY+ZmFhc2C/3G4MHmvoobbqDGqg30a92PNzPfLPdmyurV52bBfZGzvH74wdzP/swzMGiQ7TQC4OabzbBkPXvyp7df4pqlD/HHK//o8dNPHDrBrHtmseGjDdRrW49bP7g1qDv2lJeUwGKbNkHXrvDss7Lz+5ubboJp02h150P0rNWecd+M8+hpbuvVVxFSAMCMiNulC/z97zAgMEZycZ1u3WDSJEY//S1vLBlPXmFeqau7sVdfRchv5JdfzLv/iBGmW6rwXz170vDEa9zz7j1kXbj9rKvkn8jn0z9+yvcTv6dWs1r0+6Cfqzr2lJe7WwD5+XDbbWaEnmHDbKcRnujXj1Ht/8rh4weZ/8PpvQPd3quvItxdAB5+2Jzll2v8AaXGw6NIKIhm8Dv9OXziECC9+irKvYcAkyfD3Lmmh9+qVbbTiPJQiuoNm9N1YSR/GdeFW48/wzf/+IboetH0n9WfhE7u7dhTXu4sAN9+a27pXbgQzpOzwgFJKZ4c+jnJ77SjypejuKLzH+j7bl/Xd+wBeG3Zax6v675DgJ07oV8/M559q1a204gKys3J5d3eGQya0Yv3blhCqzERsvMD6VvTGb1wtMfru6sAaG2Grx48GG6UyYsCkdaab5/7lv0b95N3LI/bJzzDhLgh9P30LrIPnP3KgFtsObCF22fezjt93vH4Oe4qAFOnmim0R460nURUwKmx+h6eT3hk+Kmx+m4e/hpD9jQk9dUOHCo6Keg2e4/upcc7PXjs6se4rul1Hj/PPQVg505z1n/KFNO1VASUM3v1nX/h+b/26lOKx//2BVeu2s9NE1PIyc2xG7aS/XL8F65/+3puvvBmHrzywXI91x0FoLjpP2wYXHaZ7TSinM7Wq+/Me/dV48a80vUFWq/YTrdp17umJbD36F6unXotXZp04alrnyr38x0pAEqpyUqpPUqptU5sz3HFTf/HHrOdRJRD3vG8co3VFzL0D7y+/VLaZmlSpqaw/VBwnxPY/MtmOk3pRI8WPRjXdVyFBjRxqgUwBeju0LactWuXmbRSmv4B5cCWA0xOnly+Xn1KETJxEq++8iP961xL+0ntWbx9ceUErmQLtiwgeXIyD7Z7kKeufarCoxk5UgC01l8BvzixLceNGQN33SVN/wCz5JUlFevVl5CAGvEIf33rJyb0mECvGb2YsnKKT7NWJq01ryx5hTs/vJP3bnmP+664z6vtKacGWlRKNQY+0Vq3Ocf3hwBDAGJjYxPT0tIced1SnTxpBvho0wZCQ8+5Wk5ODtHR/nMN2d/ygIVMGvKO5REedfYpuErNozWsXQtNm3Kiaig/HfiJyPBIGlVvRGjIuf8PvFEZv5+8wjx+PvQzJ/NP0qxWM6qEnrtFm5KSkqm1Tipzo1prRxagMbDWk3VbtGihK8Vtt2n91FNlrpaenu77LOXgb3m09r9MZeaZNEnrTp20LizUR3OP6j9//mcd91yc/vCHD+3k8UJhYaGetmqarvNsHT3qy1H6ZP7JMp8DLNce7IvBexUgMxO++goeesh2EmHDwIGwZw98/jmR4ZE83+153u/3PiMWjKBvWl827d9kO6FH1uxew43v3Mi4b8bx2YDPeDLlyVLf+csreAvAY4/B449DVJTtJMKGsDB4+mkzrmNhIQDJjZJZ9YdVXBF/BcmTkxk6Zyg7D++0HPTsth7YysCPBtJlWhe6X9Cd5UOWc3nc5Y6/jlOXAd8FFgMtlVI7lFK/d2K7Ffbll/DTT+bav3Cv3r0hIsJMS16kWng1Hun4CBsf2EiNiBpc8volDJs7jHV71tnLWcKK7BUMnj2YpDeTaFKzCT/+8UeGtx/u6Lt+SU5dBbhdax2ntQ7XWjfQWk9yYrsV9uyz5t0/PDjmcBcVpJS5CvTcc+bEYAm1qtViXNdxrLlvDbUja9N1Wlc6T+lM2ro0TuSfqNSYx/KOMW3VNDpM6kDvGb1pel5T1g9bz5iUMVSvWt2nrx18hwCbN8Py5dC/v+0kwh907Qo5ObD47P0B4mPiGZMyhm0PbWPYFcN4ffnr1H2uLn3T+jJ15VT2Ht3rk1i7cnYxccVEUt9Npd5z9Zi+ZjqPdnyUrcO38tjVj1EnqnLmngy+8QBef93M3xcho8EIICQE7rsPxo+Hq64652rhoeH0u6gf/S7qx75j+/j0x0+ZvXE2wz8fTqMajUiMTyQxLpGk+CRa1W5F9arVPep8o7Xm4ImDrNu7jsysTDKzzZJ1JIvuzbpze5vbmdp7KudVszMuRXAVgOPHTY+/pUttJxH+5O67zYjPe/Z4NKtz7cjaDLx0IAMvHcjJ/JOs2bPm1M77n5X/YdP+TRQUFhAfE09cTByxkbH0qNKDCTMnUKALyC3IZc/RPWQfySY7J5vwkHAurH0hiXGJdEroxJ87/JmLYi8iPNT+IWpwFYD33jPzyTVtajuJ8Ce1aplp3iZPNiNBlUPVsKokxSeRFH96n5ojJ4+QnZNN9pFs9h3bR8jPIdwUfxNhIWGEhYQRGxVrCkR0HFFV/PdKVHAVgPHj4YknbKcQ/uj++6FvX3NLeCm9Qj0VUzWGmKoxtDi/BQAZezK4+ZKbvd5uZQuek4ArV5omXnf/vCdJWJaYaJr/8+fbTuJXgqcAfPyxGevPgeougtRtt5n/E3FK8BSA2bOhZ0/bKYQ/S02FOXNO9QwUwVIAtm+Hn38u9TKPEDRvDtWrw4oVtpP4jeAoAHPmmFF+w4LrnKbwgdRU01oUQLAUgNmzzR9WiLJIAThN4BeAI0fMTD/XX287iQgE7dubEaK3bbOdxC8EfgFYuBDatTPHdkKUJTTUXCqeN892Er8Q+AVg2TLT+08IT115pblhTARBAcjMNJ08hPBUYqL5vxEBXgC0lgIgyu/SS2H9ejNorMsFdgHIyoK8PGjUyHYSEUgiI+GCC8zIwS4X2AUgMxOSkszIL0KUR1KSHAYQDAVAmv+iIuQ8ABDoBWDtWnM8J0R5XXoprF5tO4V1gV0Adu6EBg1spxCBqEEDcw7J5QK7AGRnQ3y87RQiEMXFmYljHZoaL1AFbgHQ2vwB65UxY6wQZxMRYSaN2b/fdhKrArcA7N8P0dEy+q+ouPh404p0scAtAFlZphknREXFxbn+PEDgFoDsbCkAwjtxcdICsB2gwvbsgbp1bacQgaxuXfN/5GJOTQ7aXSm1USm1WSlVvoHXK+rkSTn+L8306dC4sZkZp3Fj81icLiICcnNtp7DK6zG0lFKhwL+BrsAOYJlSarbW+gdvt12q/HwZAuxcpk+HIUPg2DHzeNs28xhgwAB7ufxNWJi5l8TFnGgBtAM2a623aK1zgRlALwe2WzopAOc2cuSvO3+xY8fM18WvwsLM/5GLKe1lRwil1C1Ad6314KLHdwFXaq0fOGO9IcAQgNjY2MS0tDSvXpc9e8xhQMOG3m0HyMnJITo62uvtOMXrPKX1ca/gvRNB9zsC04+koADq1/ePPA5KSUnJ1Fonlbmi1tqrBegHTCzx+C7g1dKe06JFC+218eO1HjrU++1ordPT0x3ZjlO8zpOQoLXpKnX6kpBgL5PDHMkzerTWf/ub99vR/vf7AZZrD/ZfJw4BdgAl34YbAL6/uCrNt3MbO9bc815SZKT5uviVHEY6UgCWAc2VUk2UUlWA/oDvx12uUsX1Z3DPacAAmDABEhLMWAkJCeaxnAA8XV6e6wuA1z+91jpfKfUAMA8IBSZrrdd5nawstWvDvn0+f5mANWCA7PBl2bsXmjWzncIqR8qf1vpT4FMntuUx6cYpvCXdyQO4J6DcyCG8JbeTB3ABiI2FX35xfUcO4QVpAQRwAQgNhTp1YPdu20lEIMrLg4MHzRuJiwVuAQA5DyAqbtcus/OHhtpOYlVgF4D4eDMuoBDlJc1/INALQKtWMrmDqJg1a6B1a9sprAvsAiBju4uKKp5UxuWkAAh3kkllgEAvAE2bQk6OXAkQ5ZObaw4dL7vMdhLrArsAKCWtAFF+69ZBkyZmWHCXC+wCAFIARPlJ8/+U4CgAy5bZTiECybJlUgCKBH4BSEmBhQvhxAnbSUQg0Bo+/xy6dLGdxC8EfgGIjYWLL4aMDNtJRCBYvdqMASB9AIBgKAAAqakw2/djkIggMHu2+X9RynYSvxA8BWDOHNfP9Co8UFwABBAsBaBlSzPJw8qVtpMIf7ZzJ/z0E3TsaDuJ3wiOAqCUHAaIsn3yCdxwA4SH207iN4KjAAD06gUffCCHAeLcZs6U5v8ZgqcAdOxoJgpZvNh2EuGPNm82h4i9fD9pVSAJngIQEgL33Qf//rftJMIfvfYa3HOPTCh7huApAAB33w1z57p+ymdxhmPHYOpUGDrUdhK/E1wF4LzzoG9fmDTJdhLhT957D6680tw9Kk4TXAUA4P774fXXzaSPQgCMH2/+L8RvBF8BSEw0Y73NnWs7ifAHy5bB/v3QvbvtJH4p+AoAwJ/+BE89JZcEBTz5JAwf7vrRf88lOAtAv35m5teZM20nETZ9/bUZ/PMPf7CdxG95VQCUUv2UUuuUUoVKKf8ZYTEkBJ55BkaOlCnE3UpreOQRGDMGqla1ncZvedsCWAv0Ab5yIIuzrr8e6teH//zHdhJhw9y5ZuafO++0ncSveVUAtNbrtdYbnQrjKKXgH/8w7wDHjtlOIypTQQE8+ig8/bQc+5dBaQdOlCmlMoC/aK2Xl7LOEGAIQGxsbGJaWprXr+uRLVsgMhLq1TvnKjk5OURHR1dOHg/4Wx7wv0yl5tm/H/btM3eJ+kMeC1JSUjK11mUflmutS12ABZim/plLrxLrZABJZW2reGnRooWuNBs2aF27ttbbtp1zlfT09MrL4wF/y6O1/2U6Z55fftG6fn2tv/7aP/JYAizXHuyLYR4UiMAePK1lS3MZ6N57zVhwMhJMcPvTn6B3b0hOtp0kIATnZcAzjRhhmoTSRTi4zZ0LixaZcz/CI95eBrxZKbUD6ADMVUrNcyaWw8LDYcoUc2Lo559tpxG+cOCAudln0iTwo2Nxf+ftVYCPtNYNtNZVtdZ1tdbdnArmuIsvNocCgwdLD8Fg9NBDpunfubPlIIHFHYcAxUaMMGeIJ060nUQ46ZNPTK8/afqXW5knAYNKeLi5LzwlxUwN3bat7UTCW1u3mlZdWpo0/SvAXS0AgDZtzO2hvXvLrMKB7sgRM8bfyJHQqZPtNAHJfQUAzM1CAweawUNyc22nERU1cKAZ6OOBB2wnCVjuLABgugjXri0DRQSqrCzYu9eMASl9OyrMvQUgJASmTYMlS2QMwUDz/vvmZO7MmXKnn5fcWwAAYmJg1izYtQs+/dR2GuGJJUtMq61ZM6hb13aagOfuAgBmoMgLLoBBg+CLL2ynEaVZscKc9JsyBapVs50mKEgBAIiKMrMK9e9vupIK/7N2Ldx4oxnf/6abbKcJGlIAil1zDbzzjrkysHCh7TSipFWroGtXePFF6NPHdpqgIgWgpK5dYcYMc5lw/nzbaQTA8uXQrRu88grcfrvtNEFHCsCZrr0WPvwQBgwwH4U9GRmm2T9hginKwnFSAM6mY0f47DNzg8nf/y43D9nw2mtw222mRSYz+vqMu+4FKI/ERHPJqU8fWL3anHmOirKdKvjl5pq7Nr/6Cr791lyhET4jLYDSxMVBerq5ySQ5GbZts50ouO3da0Zz3rnTTPMuO7/PSQEoS0QETJ5s+gm0by+XCX1l9Wpo184U2o8/hurVbSdyBSkAnlDKjDU3ZQrccguMGgUnT9pOFRwKCuD5583J16efhrFjTTdtUSnkN10e3bqZa9Jr1pjxBDIzbScKbBs3mtt458yBpUvlMp8FUgDKq149+OgjM+3UjTdKa6Aiit/1O3aEO+6AL780XbJFpZMCUBFKmX4C0hoov5Lv+kuWwLBh0uS3SH7z3ijZGrjpJjNAxdattlP5p127zF18ycmmqS/v+n5BCoC3ilsDP/5o/qGTksx1bBljwDh0CB5/HC66yEzRtnGjGcFH3vX9gvwVnBITA6NHw/r15nGrVubx4cM2U9lz4oQ5zm/e3Ize8/338NxzcP75tpOJEqQAOK1OHXj5ZXMTy5YtZgcYOdI9E5Ls3m0u5TVrZobqzsgw/SgaNbKdTJyFFABfadIE3nrLdGk9etQMQd6rF8ybB4WFttM5S2vTQer22+HCC02PyU8+MedHWre2nU6UQgqAr7VsCS+9ZFoAPXuaE4YtWpjm8b59ttN559Ahc9POJZeYyVc7dDAnQSdMgMsus51OeEAKQGWJijITWKxYAW+/DStXmr7unTqZY+NNm2wn9My2bfCvf5k++w0bwoIFpsCtXw8PPgg1a9pOKMrBq7sBlVLPAj2BXOAn4B6t9UEHcgUvpcw9Be3bmxNlX34Js2eb2YpiYsytr506QV6emcnItoICU7Syssy7+s6d0KMH3HefGS9BZuMJaN7eDjwfeFRrna+U+ifwKDDC+1guERFhehMWj3W3YoUpBtu3m3fSNm3MbclJSeZj69a+LQoFBeYy3fLlpmNTZqbp7NSwoTmR+e9/m8IVGuq7DKJSeVUAtNb/LfHwO+AW7+K4mFJmJ09MNGfOd+82hwnLl5tbkp97zjS/27QxZ9jj4iA+3nws+XlMzLlf4+hRyM42S1bW6Z9v3Wp29nr1fs3Ru7c5eVmzpsmUnFwpvwpReZwcEOR3wHsObs/doqNNX/mOHX/9Wk6OKQpbt5odd/t205225I58/DiEhZklNNS8q+fnm6Vq1d8WjLg407JISDBNfDmGdxWlyxjuSim1AKh3lm+N1FrPKlpnJJAE9NHn2KBSaggwBCA2NjYxLS3Nm9yOysnJIdqPjmW9zqP16cOYKeX19FlB9ztymL/lSUlJydRaJ5W5otbaqwUYBCwGIj19TosWLbQ/SU9Ptx3hNP6WR2v/yyR5Sgcs1x7si95eBeiOOel3jdb6mDfbEkJUPm/7AfwLiAHmK6VWKqVedyCTEKKSeHsVoJlTQYQQlU96AgrhYlIAhHAxKQBCuJgUACFcTAqAEC4mBUAIF5MCIISLSQEQwsWkAAjhYlIAhHAxKQBCuJgUACFcTAqAEC4mBUAIF5MCIISLSQEQwsWkAAjhYlIAhHAxKQBCuJgUACFcTAqAEC4mBUAIF5MCIISLSQEQwsWkAAjhYlIAhHAxKQBCuJgUACFczKsCoJT6u1JqddHMwP9VSsU7FUwI4XvetgCe1VpforW+DPgE+Jv3kYQQlcWrAqC1PlziYRSgvYsjhKhMYd5uQCk1FhgIHAJSSllvCDCk6OFJpdRab1/bQbWBfbZDlOBvecD/Mkme0rX0ZCWldelv2kqpBUC9s3xrpNZ6Von1HgUitNZPlPmiSi3XWid5ErAySJ6y+VsmyVM6T/OU2QLQWnfx8DXfAeYCZRYAIYR/8PYqQPMSD1OBDd7FEUJUJm/PAfxDKdUSKAS2AX/w8HkTvHxdp0mesvlbJslTOo/ylHkOQAgRvKQnoBAuJgVACBezVgD8rRuxUupZpdSGokwfKaVqWs7TTym1TilVqJSydnlJKdVdKbVRKbVZKfWIrRwl8kxWSu3xl34kSqmGSql0pdT6or/XcMt5IpRSS5VSq4ryjCn1CVprKwtQvcTnDwKv28pSlOF6IKzo838C/7ScpxWmM0cGkGQpQyjwE9AUqAKsAlpb/r10Ai4H1trMUSJPHHB50ecxwCabvyNAAdFFn4cDS4D251rfWgtA+1k3Yq31f7XW+UUPvwMaWM6zXmu90WYGoB2wWWu9RWudC8wAetkMpLX+CvjFZoaStNbZWusVRZ8fAdYD9S3m0VrrnKKH4UXLOfctq+cAlFJjlVLbgQH4141EvwM+sx3CD9QHtpd4vAOL/9z+TinVGGiLede1mSNUKbUS2APM11qfM49PC4BSaoFSau1Zll4AWuuRWuuGwHTgAV9m8SRP0TojgfyiTNbzWKbO8jW5bnwWSqloYCbw0Bmt20qntS7Q5g7dBkA7pVSbc63r9c1AZQTxq27EZeVRSg0CegDX6aKDKJt5/MAOoGGJxw2ALEtZ/JZSKhyz80/XWn9oO08xrfVBpVQG0B0460lTm1cB/KobsVKqOzACSNVaH7OZxY8sA5orpZoopaoA/YHZljP5FaWUAiYB67XWL/hBntjiK1hKqWpAF0rZt6z1BFRKzcSc5T7VjVhrvdNKGJNnM1AV2F/0pe+01p52bfZFnpuBV4FY4CCwUmvdzUKOG4GXMFcEJmutx1Z2hjPyvAt0xtx+uxt4Qms9yWKejsAiYA3mfxngMa31p5byXAJMxfy9QoA0rfWT51zfVgEQQtgnPQGFcDEpAEK4mBQAIVxMCoAQLiYFQAgXkwIghItJARDCxf4fC0DjHVFXXJEAAAAASUVORK5CYII=
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[37]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.2</span>

<span class="n">mtv</span> <span class="o">=</span> <span class="n">circle_vs_circle</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">r1</span><span class="p">],</span> <span class="p">[</span><span class="n">c2</span><span class="p">,</span> <span class="n">r2</span><span class="p">])</span>

<span class="n">plot_add_grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">c1</span> <span class="o">-</span> <span class="n">mtv</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">mtv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mtv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">plot_vector</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">c1</span> <span class="o">-</span> <span class="n">mtv</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<ul>
<li><em>Just moving the shapes out of each other does not seem realistic for a simulation. We will later look at a better way to handle separation.</em> </li>
</ul>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#sub_sub_header Polygon vs. Polygon 

<p>Polygons are a LOT more complex than circles. Let's just appreciate we are not dealing with concave ones. 
#ext_link[Separating Axis Theorem](https://en.wikipedia.org/wiki/Hyperplane_separation_theorem) is a popular way to handle the polygon vs polygon case so let's not try to reinvent the wheel. It's fast and it's really accurate. The idea is simple. If we can find an <em>axis of separation</em> between the polygons then they are not overlapping.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[38]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;-.&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>

<span class="n">vertices1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">vertices2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">]])</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The yellow line goes between the two polygons - it's called a <em>separating line</em>. The blue line is called the <em>separation axis</em> (it's the line that is perpendicular to the separating line). The theorem states that if we can find at least one of these, then the polygons are not overlapping. I mean that's kind of intuitive, right? But how do we do it in code?</p>
<p>We need to decide which axes we will need to test. We can't test all infinitely many directions and positions.. And here is where <em>projection</em> saves the day! We turn the 2D problem into a couple of 1D problems.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[39]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">vertices1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">vertices2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">min1</span><span class="p">,</span> <span class="n">max1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">min2</span><span class="p">,</span> <span class="n">max2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">min1</span><span class="p">,</span> <span class="n">max1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">min2</span><span class="p">,</span> <span class="n">max2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">vertices2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">]])</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>You can see how we project the shapes into their "shadows" (these are also called their <em>orthogonal projections</em>) on the blue line. You may think that we lose information this way - and you are right. The shadows overlap in this example, but the shapes don't. We solve this problem by testing more axes:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[40]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">vertices1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">vertices2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">min1</span><span class="p">,</span> <span class="n">max1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>
<span class="n">min2</span><span class="p">,</span> <span class="n">max2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8</span><span class="p">],</span> <span class="p">[</span><span class="n">min1</span><span class="p">,</span> <span class="n">max1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8</span><span class="p">],</span> <span class="p">[</span><span class="n">min2</span><span class="p">,</span> <span class="n">max2</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">vertices2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">]])</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Here we can draw a perpendicular line in that small gap between their shadows. That line will pass between the two polygons - so they definitely aren't colliding. If the algorithm doesn't find such an axis then they are definitely colliding.</p>
<p>Now we need to choose a set of axes which we need to test. For 2D shapes it turns out it's enough to test each normal of each edge of the shapes. Remember that the normal is the vectors perpendicular to an edge and pointing outwards.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[41]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_line_from_two_points</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">ls</span><span class="p">):</span>
    <span class="n">a_coeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">b_coeff</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a_coeff</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">y</span> <span class="o">=</span> <span class="n">a_coeff</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b_coeff</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="n">ls</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[42]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Take one edge and calculate it&#39;s mid point and normal</span>
<span class="n">e1</span><span class="p">,</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">vertices2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">vertices2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># We don&#39;t need to normalize it. We do this just for the pretty picture.</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">normalized</span><span class="p">(</span><span class="n">orthogonal</span><span class="p">(</span><span class="n">e2</span> <span class="o">-</span> <span class="n">e1</span><span class="p">))</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">e2</span> <span class="o">+</span> <span class="n">e1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot a line through them</span>
<span class="n">plot_line_from_two_points</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">vertices2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">]])</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>This blue axis is not aligned with our $x$ or $y$ axis. So we can't just <code>min</code>/<code>max</code> coordinates. We need a <em>general</em> way to project points onto a line. Let's do some algebra.</p>
<p><img src="data/projection.png" width = 250/></p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>We have a vector $\vec{v}$ and a vector $\vec{s}$ onto which we want to project it orthogonally. The projection will be the vector $\vec{s}$ multiplied by some constant $c_{\vec{p}}$. The angle between them is $\theta$. By definition of the projection we are looking at a right angle triangle.
$$ \cos\theta = \frac{|c_{\vec{p}}\vec{s}|}{|\vec{v}|}$$</p>
$$ |c_{\vec{p}}\vec{s}| = |\vec{v}|\cos\theta$$<p>Let's multiply that by $\frac{|\vec{s}|}{|\vec{s}|}$.</p>
$$ |c_{\vec{p}}\vec{s}| = \frac{|\vec{s}||\vec{v}|\cos\theta}{|\vec{s}|} $$<p>If you remember, the definition of the dot product includes a $\cos\theta$ term. Let's try to use that!
$$ \vec{s} \cdot \vec{v} = |\vec{s}||\vec{v}|\cos\theta$$</p>
<p>If we replace that we get:</p>
$$ |c_{\vec{p}}\vec{s}| = \frac{\vec{s} \cdot \vec{v}}{|\vec{s}|} $$<p>Now that we have the magnitude of $c_{\vec{p}}\vec{s}$ we just need to multiply it by the unit vector (normalized vector) in the direction of $\vec{s}$:</p>
$$ c_{\vec{p}}\vec{s} = \frac{\vec{s} \cdot \vec{v}}{|\vec{s}|} \cdot \frac{\vec{s}}{|\vec{s}|} $$<p>Finally we get the formula for the projection:</p>
$$ c_{\vec{p}}\vec{s} = \frac{\vec{s} \cdot \vec{v}}{|\vec{s}|^2} \vec{s} $$
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[43]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">project</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[44]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plot_line_from_two_points</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices1</span> <span class="o">+</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">vertices2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">]])</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">plot_vector</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;purple&quot;</span><span class="p">)</span>

<span class="c1"># Take one vertex and make a vector between the midpoint of the edge and it</span>
<span class="c1"># We actually don&#39;t need this too since we can move vectors freely around space </span>
<span class="c1"># and we just care about the coefficent of the projection at the end.</span>
<span class="c1"># Again, we do this for the picture below.</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">vertices2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mid</span>
<span class="n">plot_vector</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="n">v</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">projection</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">plot_vector</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="n">projection</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>We constructed the red vertex from the vertex and the mid point of the edge and projected it onto the normal vector of the edge.</p>
<p>We can now find the <code>min</code>/<code>max</code> of the <em>projections</em> of all vertices and get the picture we had before:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[45]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_projection_of_shape</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
    <span class="n">min_proj</span><span class="p">,</span> <span class="n">max_proj</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;Inf&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="n">v</span> <span class="o">-</span> <span class="n">mid</span>
        <span class="c1"># We actually want to find the min/max coefficent so we don&#39;t multiply by the axis here.</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">min_proj</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">min_proj</span><span class="p">)</span>
        <span class="n">max_proj</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">max_proj</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">axis</span> <span class="o">*</span> <span class="n">min_proj</span><span class="p">,</span> <span class="n">axis</span> <span class="o">*</span> <span class="n">max_proj</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">offset</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">)</span>
    
<span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_line_from_two_points</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">vertices2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">]])</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">plot_projection_of_shape</span><span class="p">(</span><span class="n">vertices1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plot_projection_of_shape</span><span class="p">(</span><span class="n">vertices2</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAD8CAYAAACYVXqwAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/d3fzzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAll0lEQVR4nO3deXxU1dnA8d+TkLALIiBhUVyAosgiqFjqghvUBVdcKiRV29cqWCv6Fq2tYrGvtpZatVK1tgICKgpUpCqVCmK1yqKEgARKKWoIO4oEkJDkef+4M/EmZBkyZ+bO8nw/n/mQ3Eye+yRknjnnnnPPEVXFGJOeMoJOwBgTHCsAxqQxKwDGpDErAMakMSsAxqQxKwDGpLFGLoKIyAZgN1AOlKnqABdxjTGx5aQAhAxW1e0O4xljYsy6AMakMXExE1BE/gt8ASjwtKo+U8Nz/gf4H4AmTZr0P+qoo6I+b3UVFRVkZLitabGIaXFjF9PietauXbtdVdvV+0RVjfoBdAz92x7IB86s6/ndu3fXWFiwYEFSxLS4sYtpcT3AUo3gteuk7KhqcejfrcBs4FQXcY0xsRV1ARCR5iLSMvwxcAGwMtq4xpjYczEKcCQwW0TC8aar6psO4hpjYizqAqCq64E+DnIxxsSZDQMak8asABiTxqwAGJPGrAAYk8asABiTxqwAJAFbt9XEihWABDd5Mhx/PHz9ddCZmFRkBSDBdekCAwfCrl1BZ2JSkcv1AEwMnHOO9zAmFqwFkCSKi+HLL4POwqQaKwBJ4PPPva7Ac88FnYlJNdYFSAJdusDjj8PQoUFnYlKNFYAkMWpU0BmYVOSsCyAimSLysYjMdRXTVLV4McycGXQWJpW4vAZwO7DaYTxTza9/Df/7vzYxyLjjpACISGfgIuBZF/FMzX73O1i+HLy1V0yNFi2i84wZQWeRNFytCvwK8BDQErhLVS+u4TmVqwK3a9eu/4wY/CeVlJTQokWLhI9pcWMXs9/o0bRatYqV48ax/ayznMZOpt/t4MGDl2kkG/REsnJoXQ/gYmBi6OOzgbn1fY+tCtzwuIsXq154oerOnW7j1icpfreff64KWp6Zqdquneq2bU7DJ9PvljiuCjwIGBbaHuxF4BwRmeogrqlBRgasWgXr1gWdSQIKXSH95Be/8GZNjR4dbD5JwMWagPcA9wCIyNl4XYAR0cY1NTv5ZFi/3isEppoZM6B3b6/pn5kJv/gFDB8OV14ZdGYJy/6MkoyI9+JXtTsEqygqgvffh6uv9j4fO9arlrfcAttty8raOC0AqrpQa7gAaNzavx9OOAEefDDoTBJIeILE8OHev1lZMGmSdQXqYS2AJNS4MVx2mfcGZ0JCzX+6d//m2EknwX33wUsv2QyqWlgBSFIPPQRXXBF0FgmievPfz7oCdbICkMT27vX+7tNe9ea/n3UF6mQFIInddRdccAGUlASdScBqav77WVegVlYAkthtt8Hf/gbNmgWdSYDqav77WVegRlYAkljPnnDWWWk+J6Cu5r+fdQVqlM5/Oilh2zYYP95bNSgt1df897OuwEGsACS5khIYNw4WLAg6kwBE2vz3s65AFVYAktwxx8DGjZCbG3QmAYi0+e9nXYEqrACkgA4dgs4gIIfS/PezrkAlKwApYvRob7WgtNGQ5r+fdQUAKwApo6LCe6SNhjT//awrAFgBSBkTJ8KECUFnEUcNbf77WVcg+gIgIk1EZLGI5IvIKhF5wEVipmG+/DIr6BRiL9rmv1+adwVctAD2A+eoah+gLzBURAY6iGsO0VNPwfDhp7NlS9CZxFi0zX+/NO8KRF0AQkuQhWejZ4UetnB1AM45B/LyNpCV6o0AF81/vzTuCrhaFTgTWAYcDzypqmNreI6tChxg3IzSUjL37uVA69ZO40ajITEbb9vG6VdfzfqbbuKzETWvPNeQuFJWxsm33krjbdtYMmkSB1q1chI3Ekm9KrD/AbQGFgC96nqerQocu7j/+McCfftt1f/8x3ewvFz16KNVb7ihwXET5nf7+9+rguqaNW7jqqquWKGalaV6zTVu49Yj2VcF9heTL4GFgG1jGZDduxsxZIh3PaBSRgacey68/DLs2RNYbk64bv77pWFXwMUoQDsRaR36uClwHlAYbVzTMK1alTF/vnd/QBV5ed6NA7NnB5GWGy6v/tcmzUYFXLQAcoAFIrICWAK8paq2QWiAzjyzhjUCvvMd78aByZMDyckJl1f/a5NmowIuRgFWqGo/Ve2tqr1U9ZcuEjPRmTHDu024UkaGd8fQP/6RvPcOx7L575dGXQGbCZii3nsPXnkFyst9B0eO9DYUmJqEGzfFo/nvlyZdASsAKerhh72dhDMzfQePO87rCkyZknx7jMej+e+XJl0BKwApqmlTbxehg17neXlQWAhLlgSSV4PFq/nvlwZdASsAKeyf/4SuXWHNGt/B4cOhSZPkuhgY7+a/n68rkLVrV/zPH2NWAFLYccfBiSdW20OwVSu4/HJ44QVvj7FkEO/mv5+vK9Dtscfif/4YswKQwnJy4PXXoU+fal/Iy4MvvoC5STJaG0Tz3y/UFWi/YEHKdQWsAKSBXbu8dQMrnXeeVx2mTAksp4gF2fz3GzuW3d26eaMC27YFm4tDVgBSXHk5fOtbcO+9voOZmTBihNc8SPQ/5iCb/35ZWRTefbc3KnDbbcHm4pAVgBSXmQm//W0NI1l5eVBWBtOnB5JXxIJu/vvsOfbYlBsVsAKQBq6/HgZUvzH0xBOhf//EHg1IlOa/n3+CUKK3niJgBSBNrFsHzz5b7WBeHnz8MRQUBJJTvRKl+e/nnyCUAl0BKwBpYtq0Gt60rr0WGjVK3IuBCdT8ryKFJgi5uB24i4gsEJHVoUVBb3eRmHFr1Cj47DNo1853sF07uOgi796AsrLAcqtRIjb//VKkK+CiBVAG3KmqPYGBwCgROcFBXONQ27beyN9B8vJg82Z4662451SnRGz++6VIV8DF7cCbVPWj0Me7gdVAp2jjGveKiuB734PFi30HL7oIjjgi8S4GJmrz3y8FugJOrwGISFegH/Chy7jGjcMOg3ffhfXrfQezs+G66+Cvf/XezRJBojf//ZK8K+BkVWAAEWkBvAP8SlVn1fB1WxU4AeJWVHhrg/i1LCyk/y23sGbMGDZdckmD4jZEbTE7vfIK3Z58kg+nTGFfly7O4kartrjN16+n/803s/2MM/jkvvucxY1GXFcFxtsLYB4wJpLn26rAwcfdt8/3SUWFas+eqoMGRR33UNQa89vfVu3d233cKNUZd/x4b7XiV15xG7eBiNeqwCIiwJ+B1ar6u2jjmdi74gq46irfARHvYuB773kTBoKUTM1/vyTtCri4BjAIGAmcIyLLQ48LHcQ1MXLuuXD++dUOjhjh9Q2CnhOQ6Ff/a5OkowIuRgH+qaqi3qKgfUOP110kZ2Jj1Ci4vfpsjU6dvLsEp0wJdp/xZLj6X5skHBWwmYBpqqwM3nmn2sG8PPj0U1i0KJCckrb575dkXQErAGnqL3+Bs8+G/Hzfwcsug5Ytg+sGJGvz3y/JugJWANLUlVfCrFnQs6fvYLNm3osvqC3Ekrn575dEXQErAGnqiCO8pQGzs6t9IagtxFKh+e+XJF0BKwBp7OuvYeJEb/SvUlBbiKVC898vSboCVgDSWEYG3H+/1xWocjCILcRSpfnvlwRdASsAaSw721sLZMKEal8IbyE2bVp8Ekm15r9fgncFrACkuQ4dajgY3kJs8uT4bCGWas1/vwTvClgBMDz2mHdBsIp4biGWis1/vwTuClgBMJWqbBQUry3EUrn575egXQErAIbbb/dG/Ro39h2M1xZiqdz890vQroAVAFNpx45qtwHk5sZ+C7FUb/77JWBXwAqAAbyVgnJyYOFC38Hzz4/pFmKNt21Lj+a/X4J1BZwUABH5i4hsFZGVLuKZ+BswAH7yEzj6aN9B3xZiWTFYLqxt+G6kVG/++yVYV8BVC2ASMNRRLBOApk3hN7/xRgCrCG0h1n7+fOfnbL9wYfo0//0SqCvQyEUQVV0UWhDUJLkVK7xrfqecEjoQ2kKsw9//7vZERUW0WrUKzjnHm4/sUMe1a+GTT5zGdB63ZUvv36uuotWjj3q3ZgbA5aKgXYG5qtqrlq/boqAJHlcVRow4jY4d9/HIIysqj3eaNYtuTzzBkj//2dsg04GWhYX0GzWKjCAXH0kQXx11FB85Hm6NdFHQuBUAvx49euiaNWucnNdv4cKFnO24ksYiZiLHXbLEuxeobVvfwW3bqMjJIeOOO+CRR6LOMezduXM549RTncULe++99xg0aFByxC0sZNG+fZw5ZIjTsCISUQFw0gUwqaOy6e/Xrh07Bw6k7dSp8NBD3n6CDpS3aAHt2zuJ5Xfg8MOTJ2779lRUGXqJLxsGNAf55z+9dQP9jcPNQ4Yk5hZiJiquhgFfAP4F9BCRIhG5yUVcE4y1a72L0xs3fnNsx8CBibmFmImKq1GA61zEMYlhxAhvEqC/pa9ZWd4WYn/6kzeG3bp1UOkZh6wLYA6Snf3Ni7/KNeLcXG+M8OWXA8nLuGcFwNTo88+hb1945RXfwQEDvFVErRuQMqwAmBp17AhdungLBVdKpC3EjBNWAEyNMjPhtdfgoouqfSFRthAzTlgBMHUqLYX1630H4ryF2IHyA8xZM4eJSybiatKa+YZNBDJ1uuQS2LIFfv9738HcXK8lsGhRTOawqyofb/6YKflTmF4wnW17vdtmMySDHw34kfPzpTMrAKZOd94J5eXVRgMuv/ybLcQcFoBNuzcxrWAak/Mns3LrSrIzsxnWYxi5vXN5YvETjJk3hsFdB9OjbQ9n50x3VgBMnS64wPu3ymzV8BZiM2bAE09A8+YNjr/vwD5eXfMqU/KnMO8/86jQCk7rdBoTL5zINb2uoU3TNgD079ifk/54EiNmj+D9G98nKzOr4T+UqWTXAEy9tm6FmTM7UVbmOxjFFmKqynufvcdv1/6WnAk5XDfzOlZuXcndg+6mcFQhH/zgA2455ZbKFz9Ax5Ydefrip1lavJTxi8Y7+KkMWAvAROBf/4I//KEbw4fDmWeGDvq3EBsxIqI4G77cwPP5zzNlxRTW7VxHk4wmDO81nLw+eQw+ZjAZUvf70VUnXEVun1x+9e6v+O7x3+X0LqdH+ZMZKwCmXt/9LkyevJgzz/TduhveQuyXv/RmDXXpUuP37t6/m1c+eYXJ+ZN551NvCbDBXQdz7xn30n57ey4878JDyuXxoY/zzoZ3GDl7JMt/tJwW2e7XVEgn1gUw9crOhqOO2nvwF2rZQqy8opz56+czcvZIOkzowI1zbqR4dzHjB49nw+0beDvvbb7f9/s0a9Ts4Jj1aNWkFc9f/jzrv1jPHW/e0dAfyYRYC8BEpLQ0g9GjYeBAX4vfv4XY2LEU7ljD5OWTmVowlaKvimjVuBUje48kr08eAzsPRESc5HLG0WcwdtBYHn7vYS7qfhGXfesyJ3HTkZMCICJDgceATOBZVX3YRVyTOLKyKvjwQ2jXrurxkuuupMWoO7jh572YlP0JmZLJkOOHMOGCCQzrMYwmjZrEJJ8HBj/AvP/M44ev/ZCBnQfSoUVNmxya+kRdAEQkE3gSOB8oApaIyBxVdb8qowmMCHz4odf1P1B+gDfWveH16zfO4fNGMOSfWzjp4Ql876TvxeXFmJ2ZzdQrptL/mf7cNOcm5l4311kLI524uAZwKrBOVderainwInCpg7gmQMs3L2fo1KFsLtkMeEN3+Vs+5idv/oROv+vEpS9eyrufvsvIM0bz9SVDubaggjEnj4rrO/EJ7U7gN+f9htf//TpPL3s6budNJVEvCioiVwFDVfUHoc9HAqep6uhqz7NVgZMo7md7PyNvSR65R+XSrFEz3ih+g0+//pQMzSb7vxfx84tP4bQjTqFRRiPaLF5M77FjWfnAA2yvHCeMT64VWsHYgrGs3LWSZ/o/Q5dmXRL+dxuPuJGuCoyqRvUAhuP1+8OfjwSeqOt7unfvrrGwYMGCpIiZ6HH3HdinLxa8qK0eaqWMQxmH9pzQUycunqgv/HWH/uxnqnv2+L6hrEw1J0d12LC456qquvGrjdrm1230lGdO0dKy0oT+3cYrLrBUI3j9urgIWAT4B4E7A8UO4po4UlXe//x9JudPZsaqGezav4vDmxwOwKyrZ3H4lsM5+5SzAbi2egcvvIXYo496+91Vv1IYY+FZgsNfHs6Dix5ksAyO6/mTmYtrAEuAbiJyjIhkA9cCcxzENXGw4csNjH9nPN3/0J3vPPcdphVMY1iPYcwfOZ+1t60lOzObRZ8uqvI9qt4FwT17fAdDW4gxfXp8f4CQq064irw+eTz47oOs2rUqkBySUdQFQFXLgNHAPGA1MENV7X8gge3ev5vnPn6OsyedzTGPHcN9C++jy2FdmHTpJLbctYUpl0/h3GPPpW2ztlzS/RKmFUyjrOKbGwEWL/bmA1TZ1i60hViQy4U9/t3HOarVUfxf4f9RUloSWB7JxMlMQFV9XVW7q+pxqvorFzGNW5HMzsvrm3fQ1Nq8Pnls27uNxTsXVx479VSYOhUurd4VyM2Fjz+GgoI4/EQHO6zxYUy5bAqbvt5kswQjZFOBU1zh9kLumX8PXR/ryvnPn89ra15jZO+RvH/j+6wZvYafn/lzjm59dK3fP/T4obRr1o55W+ZVHhOB66+HVq2qPfm667zlhANcLuyMo8/gui7X8ezHzzJnjfVE62NTgVPQzn07eXHli0zOn8zijYvJlEyGHj+0QbPzsjKzuP6k63ly8ZPs3Lezyi264ZHcq68OHWjXzltE0PEWYofq+12/z+oDq/nBnB9QcEsBR7Y4MpA8koG1AFJEeO28+1bdR86EHEa9Poqvy75mwgUTKBpTxNzvzeXqE69u0NTc3D65HNADvLjyxSrHn3wSnq4+/yYvz7s6WFgYxU8TnayMLKZeMZXdpbu5ac5NtpZgHawFkMRUleWblzM5f3Ll2nmts1pz64BbyeubR98OfZ2cp2+Hvhzb/Fim5E/h1lNurTw+Y0YNI34XX+ztIdjs0O/0cyk8S/DHb/6Yp5c9bWsJ1sIKQJL6av9XnDP5HJZtWla5dl5enzyaFDXhvHPOc3ouEWHIkUP44/o/smb7mso1+Y6sqWWdleU9EsCoU0cx999zGTNvDMN6DKNjy45Bp5RwrAuQpHbu28myTcv4Qb8fsOnOTbw8/GUu7n4xjTJiU9PPO/I8MiWTyflVh/leew1OPx2+/jomp41KhmRwy4Bb2Fe2j41fbaz/G9KQFYAkldMiB4CjWx9d5cJcrLTJbsOQ44fw/IrnKa8orzzetKn3hr95c8xTaJAtJVsA7N2/FlYAklTjRo05oukRFO+O36zrvD55FH1VxIINCyqPnXeetz1A165xS+OQFO8uRhAbCaiFFYAkltMyJ64FYFiPYbRq3Iop+QeP8+/bV21qcILYVLKJ9s3bx6xrlOysACSxji07sqlkU9zO16RRE6458Rpmrp7J7v27K49v2wYdOsAzz8QtlYgV7y625n8drAAksZwW8W0BAOT1zWPvgb3MXP3NjQDt2sEdd8CgQXFNJSLFu4vJaZkTdBoJywpAEuvYsiObSzZTobHfpDPs9M6n061Nt4NGA8aN8+4RSDSbSjbRsYW1AGpjBSCJdWzZkbKKMrbv3R63c4oIuX1yWbhhIRu+3FDla599BvPnxy2VepVVlLGlZIt1AeoQVQEQkeEiskpEKkSk/uWHjFPhocB4dwNG9PbWBX8+//kqx++4w9sqoLy8pu+Kvy0lW1DUugB1iLYFsBK4AlhU3xONe+F3tk2743chEKBr666c3fVspqyYUmWe/YMPwvvvewsEJYLwBVJrAdQuqgKgqqtVdY2rZMyhCb+zxbsFAN6cgHU71/Gvon9VHuvZ09suMFGEfy9WAGoXt8HRaqsCs7DKftNulJSUOI8bi5iu4pZWlALwfsH7HPfVcc7i1qR63PZl7WmS0YSH3niIO7vfWXn888+b8tJLXbj55vW0bFlWQ6TaY7rOdWGxF/u/Bf+lZG30KwQl8t9Cg9W3aigwH6+pX/1xqe85C4EBkaxCqrYqsNO4R/z6CL1l7i3O41ZXU9yRs0Zqq4da6d7SvZXHli5Vbd5c9e23GxbThXDc+96+T2Wc6IHyA07jupbQqwKrqttby4xT8Z4N6JfbJ5fnVzzPnDVzuKbXNQCcfDJs2QLNmweSUhXFu4ttFmA9bBgwycV7NqDf4K6D6XxYZ6as+GZqsMg3L/6g1+HYVLLJ+v/1iHYY8HIRKQJOB/4mIvPq+x7jVhCzAcMyMzIZ2Xsk89bNq9xCDLzVwS+4AO6/P5C0Ktk04PpFOwowW1U7q2pjVT1SVYe4SsxEJojZgH55ffIo13KmrZhWeaxRIzj2WO/+gCBtKtlUOVfC1My6AEkup0VO3GcD+vVo24PTOp3G5PzJVeYEPPUU3HprHd8YYzYLMDJWAJJc+A88qG4AeK2Agq0FLN+8vMrxigpYuzaYnGwWYGSsACS5oGYD+l3T6xqyM7MPukHo7ru9UYGSADbpsVmAkbECkOSCnA0Y1qZpGy7pfgnTC6ZzoPxA5fERI7yuQBDbA9gswMhYAUhy4YtcQQ0FhoW3EHtz3ZuVx3r39opAk0PfiiBq4RaRXQSsmxWAJNe4UWPaNG0TaAsAvtlCrHo3YM8emDQJiorim4+tBRgZKwApoGPLjoEXgPAWYq+tfY2d+3ZWHt+6FW64AWbNim8+xbuLObLFkTYLsB5WAFJAkLMB/XL75FJaXlplC7FjjoH8fLjttvjmYnMAImMFIAUEORvQr2+HvpzU/qSDVg3u3dubIhxPNgswMlYAUkDQswHDRIS8Pnl8uPFD1myvukzEww/DL38Zv1yKdxdbCyACVgBSQNCzAf2u7319jVuIrV4Nq1bFJ4dyLWfrnq3WAoiAFYAUkAizAcM6tOhQ4xZizz0HL70Unxx2lu5EUSsAEYj2bsBHRKRQRFaIyGwRae0oL3MIEmE2oF9u79yDthDLCP2l7d8f+/PvLPVGIWwacP2ibQG8BfRS1d7AWuCe6FMyhyoRZgP6XfqtS2nVuNVB3YCXXoL27b0FQ2Jp+36vK2QtgPpFezvw31U1vPDbB0Dn6FMyhypRZgOGhbcQm7V6VpUtxPr0geuugwMH6vhmB3aU7gBsFmAkXF4DuBF4w2E8E6FEmQ3oV9MWYt/6lndvQOcYv03sKN1hswAjJFrPuk0iMh+oaWmHe1X11dBz7gUGAFdoLQGrrQrcf8aMGdHkXaOSkhJatGiR8DFjEffGpTfSqUknxnYdmxD5qiq5S3Jpm92WR/s+WuVrRUVNady4gqZNd8Qk14dWPcTSr5Yy8/SZ9T/5ECTL3wLA4MGDl6lq/Zv1RLJyaF0PIA/4F9As0u+xVYHdx73g+Qv01D+dmlD5jn9nvDIO/e8X/608tmuXana26pgxsfvdDnx8oPZ7qp/zuIn0u60PEa4KHO0owFBgLDBMVfdGE8tEJ1FmA/rVtIXYYYfBCy/AmDGxO++O0h12ATBC0V4D+APQEnhLRJaLyFMOcjINkCizAf1q20LsiiugU6fYnXf7/u1WACIU7SjA8araRVX7hh4/cpWYOTTh2YC7DuwKOpUqatpCDOCdd2DWLPdVoKyijC8PfGkjABGymYApIvyOFx4CSxRX9rySZlnNmLy86pyAmTNh2rSjKC11e77wWoDWAoiMFYAUUVkA9idWAWjZuCVX9rySl1a9xL4D+yqPjxsHL7zwIdnZbs8Xvg5iswAjYwUgRYT/4LeXBn9DUHW5fXLZtX8Xc9bMqTzWpg1kZ7u/XmGLgR4aKwApItznDc+DTyThLcSqTw1et6453/6226XDbTHQQ2PrJaWI8GzAT776hFcLX3Uev2B7AbsKG36B8bROpzG7cDaTPp7E4U0PB+DfGYUUH1bMKyvhREeNgaeWegNR7Zu3dxMwxVkBSCHdj+jOB0UfcNlLl8XmBA7u579hzg1VD5wO9xYABdHH9rO1ACNjv6UU8sb1b/DyWy8zYED9M0AP1dKlS6OOm/vXXL4u+5qXrnwJEamMWV4Be0q8SULR2lSyifc+ei/6QGnCCkAKad2kNd1adqNfTj/nsXe13BV13FsG3MKo10chIvTL6ceulrvo26EfvXrBKad4y4dHqx/9aLaxWfSB0oRdBDRxc22vaw/aQkwERo3yZgea+LMCYOKmti3Ebr0Vhg0LMLE0ZgXAxFVNW4gBfPEFvOp+8MLUwwqAiavathB74gm4/HLYuDGgxNKUFQATV1mZWdzc/2baNWtX5Q7BH/4Qli6FjjZ/J66iGgUQkfHApUAFsBX4vqom1k3pJuGMP2c8AAsXLqw8lpPjPUx8RdsCeERVe6tqX2AucF/0KZl0tWMH/PSnsGxZ0Jmkj2jXA/jK92lzoO4FBo2pQ1YWPP00fPhh0Jmkj3oXBa03gMivgFxgFzBYVbfV8jxbFNTi1htz374MmjaN7saAZPodxCqus0VBgfnAyhoel1Z73j3AA5EsRGiLglrc+mJWVMQmbjSSKS4RLgpa70VAVT0vwqIzHfgbcH+EzzemRj/+sTccONPtqt6mBtGOAnRT1X+HPh0GFEafkkl3nTpBdjaoelOFTexEezPQwyLSA28Y8FPAFgU1URs7NugM0kdUBUBVr3SViDHVrV0L3bsHnUVqs5mAJiFNnw49ekB+ftCZpDYrACYhDRkCjz0GXboEnUlqswVBTEI64ghvNMDElrUATMIqK4PXXoMlS4LOJHVZATAJq6ICbrwRJk4MOpPUZV0Ak7Cys2HhQhsJiCUrACahnXhi0BmkNusCmIT3wgtw001BZ5GarACYhFdUBCtWwJ49QWeSeqwAmIQ3Zow3EtC8edCZpB4rACbhZWZ6/5aWeiMDxh0rACYpfPSRd5egbxlB44AVAJMUevb0pge3bh10JqnFSQEQkbtEREWkrYt4xlTXtClMnQonnxx0Jqkl6gIgIl2A84HPok/HmLpt3QqffBJ0FqnDRQvgUeCn2IrAJg7OOgtuuy3oLFJHVKsCi8gw4FxVvV1ENgADVHV7Lc+1VYEtbtQxly1rTZs2pRxzzF6ncSORTHHjsiow8CHQKvS8DUDbSFYitVWBLW6sYlpcD7FeFVhETgKOAfLFW7mxM/CRiJyqqpvrrTzGNNAnn8CMGXD//bZoaLQafA1AVQtUtb2qdlXVrkARcLK9+E2sffABPPwwrFsXdCbJz+YBmKRz7bWwaRN06xZ0JsnP2e3AoVaAMTHXrJn3MNGzFoBJStu2wcUXw6xZQWeS3KwAmKTUpg1s3w4lJUFnktxsRSCTlDIzvYuBJjrWAjAmjVkBMCaNWQEwJo1ZATAmjVkBMCaNWQEwJo1ZATAmjVkBMCaNWQEwJo1ZATAmjUVVAERknIhsFJHloceFrhIzxsSei3sBHlXV3zqIY4yJM+sCGJPGXLQARotILrAUuFNVv6jpSf5VgYH9IrLSwbmrawvUuCpxgsW0uLGLaXE9PSJ5Ur3LgovIfKBDDV+6F/gAL3EFxgM5qnpjvScVWaqRLFl8iGIRN5lyTba4yZRrssWNNGaDVwWu4YR/AuZG8lxjTGKIdhQgx/fp5Xj7BRhjkkS01wB+IyJ98boAG4CbI/y+Z6I8bzzjJlOuyRY3mXJNtrgRxYxqazBjTHKzYUBj0pgVAGPSWGAFIJbTiEXkLhFREWnrKN54EVkRyvPvItLRUdxHRKQwFHu2iLR2FHe4iKwSkQoRiWp4SUSGisgaEVknInc7yu8vIrLV9VwQEekiIgtEZHXo57/dQcwmIrJYRPJDMR9wkasvfqaIfCwizkbQRGSDiBSE/l6X1vnkSHYQjcUDGAfcFYO4XYB5wKdEuFtxBDEP8338Y+ApR3EvABqFPv418GtHcXviTQRZiLdle0PjZAL/AY4FsoF84AQH+Z0JnAysdPx/n4O3PyVAS2BttPkCArQIfZyFtyP2QIc5jwGmA3MdxtwQ6d9+KnYBHgV+ijcy4YSqfuX7tLmr2Kr6d1UtC336Ad4Oyy7irlbVNQ5CnQqsU9X1qloKvIi3LXxUVHURsDPaODXE3aSqH4U+3g2sBjpFGVNVNbz9SFbo4eT/X0Q6AxcBz7qI1xBBF4DRoebvX0Tk8GiDicgwYKOq5jvIrXrsX4nI58D1wH2u4wM3Am/EIG40OgGf+z4vIsoXVLyISFegH947drSxMkVkObAVeEtVo44Z8nu8N6sKR/HCFPi7iCwLTcGvVUx3BqpnGvEf8aYPh6cRT8B7EUQT82d4zWqnuarqq6p6L3CviNwDjAbudxE39Jx7gTJgmqt8I41T32lqOJbw48Yi0gKYCfykWuutQVS1HOgbukYzW0R6qWpU1y9E5GJgq6ouE5Gzo82xmkGqWiwi7YG3RKQw1Oo6SEwLgMZgGnFtMUXkJOAYIF9EwGtOfyQip6rqZle54vXX/kaEBaC+uCKSB1wMnKuhDpyLuI4U4V1TCesMFMfhvA0mIll4L/5pqup061BV/VJEFgJDiX7W6yBgWOjidxPgMBGZqqojooyLqhaH/t0qIrPxunI1FoAgRwGcTiNW1QJVba+qXdXbqrwI74JQvS/++oiIfyf6YUBhtDFDcYcCY4FhqrrXRUzHlgDdROQYEckGrgXmBJxTrcSr/H8GVqvq7xzFbBcenRGRpsB5OPj/V9V7VLVz6G/1WuBtFy9+EWkuIi3DH+O1iGt9bQW5OWhDpxEH4WER6YHXV/sU+JGjuH8AGuM10wA+UNWoY4vI5cATQDvgbyKyXFWHHGocVS0TkdF4oyqZwF9UdZWD/F4AzgbaikgRcL+q/jnauHjvqiOBglCfHeBnqvp6FDFzgMkikon3hjlDVRP5prcj8bop4L2+p6vqm7U92aYCG5PGgh4FMMYEyAqAMWnMCoAxacwKgDFpzAqAMWnMCoAxacwKgDFp7P8BYVGb68m/w6oAAAAASUVORK5CYII=
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>As you can see, the projections overlap, which means that the polygons intersect <em>along that axis</em>. Remember that as long as there exists one axis on which the projections don't overlap, the shapes don't intersect.</p>
<p>Let's use all of this and create a method which checks if an axis is a separating axis of two objects:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_separating_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
    <span class="n">min1</span><span class="p">,</span> <span class="n">max1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;Inf&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">)</span>
    <span class="n">min2</span><span class="p">,</span> <span class="n">max2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;Inf&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">)</span>

    <span class="c1"># Min/max projections of v1</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v1</span><span class="p">:</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">min1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min1</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span>
        <span class="n">max1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max1</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span>

    <span class="c1"># Min/max projections of v2</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v2</span><span class="p">:</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">min2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min2</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span>
        <span class="n">max2</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max2</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">max1</span> <span class="o">&gt;=</span> <span class="n">min2</span> <span class="ow">and</span> <span class="n">max2</span> <span class="o">&gt;=</span> <span class="n">min1</span><span class="p">:</span>
</pre></div>
<p>Now that's good and all, but like we said earlier it's good if we actually get a little more information in the case when they are overlapping. We want the minimum translation vector <em>along that axis</em>. That means that in each axis where the objects are colliding we are going to calculate the vector required to move one of the objects in order to separate them.</p>
<p>In that case we just want the amount of overlap between the two shadows:</p>
<div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max2</span> <span class="o">-</span> <span class="n">min1</span><span class="p">,</span> <span class="n">max1</span> <span class="o">-</span> <span class="n">min2</span><span class="p">)</span>
</pre></div>
<p>And calculating the vector using the axis:</p>
<div class="highlight"><pre><span></span><span class="n">mtv</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">normalized</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
</pre></div>
<p>So the final method looks like:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[46]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_separating_axis_polygons</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns True and None if &quot;axis&quot; is a separating axis of v1 and v2 (v1 and v2 are vertices).</span>
<span class="sd">    Return False and the the push vector otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">min1</span><span class="p">,</span> <span class="n">max1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;Inf&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">)</span>
    <span class="n">min2</span><span class="p">,</span> <span class="n">max2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;Inf&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v1</span><span class="p">:</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">min1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min1</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span>
        <span class="n">max1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max1</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v2</span><span class="p">:</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">min2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min2</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span>
        <span class="n">max2</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max2</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">max1</span> <span class="o">&gt;=</span> <span class="n">min2</span> <span class="ow">and</span> <span class="n">max2</span> <span class="o">&gt;=</span> <span class="n">min1</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max2</span> <span class="o">-</span> <span class="n">min1</span><span class="p">,</span> <span class="n">max1</span> <span class="o">-</span> <span class="n">min2</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="n">normalized</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Now we just need to collect all polygon normals into an array and test each axes:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[47]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">polygon_vs_polygon</span><span class="p">(</span><span class="n">polygon_a</span><span class="p">,</span> <span class="n">polygon_b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the minimum push vector of two polygons (None if they don&#39;t intersect).</span>
<span class="sd">    &quot;polygon_a&quot; and &quot;polygon_b&quot; must be instances of ConvexPolygon.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">polygon_a</span><span class="o">.</span><span class="n">normals</span><span class="p">,</span> <span class="n">polygon_b</span><span class="o">.</span><span class="n">normals</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">push_vectors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">separating</span><span class="p">,</span> <span class="n">tv</span> <span class="o">=</span> <span class="n">is_separating_axis_polygons</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">polygon_a</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">polygon_b</span><span class="o">.</span><span class="n">vertices</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">separating</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span> <span class="c1"># The polygons don&#39;t overlap if there exists at least one axis of separation</span>
        <span class="n">push_vectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tv</span><span class="p">)</span>

    <span class="n">mtv</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">push_vectors</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>

    <span class="c1"># Our convention is that the translation vector returned pushes the second object away from the first.</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">polygon_b</span><span class="o">.</span><span class="n">centroid</span> <span class="o">-</span> <span class="n">polygon_a</span><span class="o">.</span><span class="n">centroid</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">mtv</span> <span class="o">=</span> <span class="o">-</span><span class="n">mtv</span>
    <span class="k">return</span> <span class="n">mtv</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The last few lines:</p>
<div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">polygon_b</span><span class="o">.</span><span class="n">centroid</span> <span class="o">-</span> <span class="n">polygon_a</span><span class="o">.</span><span class="n">centroid</span>
<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">mtv</span> <span class="o">=</span> <span class="o">-</span><span class="n">mtv</span>
<span class="k">return</span> <span class="n">mtv</span>
</pre></div>
<p>These ensure that the vector returned pushes the second body away from the first. <code>d</code> is a vector which points from A to B. The dot product tells us if two vectors point generally in the same direction or in different directions - because of the negative cosine, the product is less than zero if they form an angle biggr than 180 degrees. In that case we flip the vector. This last check is very important for consistency.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#sub_sub_header Polygon vs. Circle 

<p>The last case is polygon vs circle. This one is really easy because we can use the same separating axis technique and reuse a lot of the code.</p>
<p>There are two things to consider. Firstly, circles don't have edges (or you can think about them having infinitely many edges and in that case infinitely many normals). We <em>arbitrarily</em> choose the vector described by the circle's center and the closest vertex of the polygon to it (chosing the second vertex as the polygon's center is not the most appropriate because of the strange shapes polygons can have).</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[48]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">r</span> <span class="o">=</span> <span class="mf">1.6</span>

<span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices_5gon</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="n">plot_polygon</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">closest</span><span class="p">,</span> <span class="n">closest_dist</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;Inf&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
    <span class="c1"># We use the squared magnitude since to avoid the square root</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">v</span> <span class="o">-</span> <span class="n">c</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">closest_dist</span><span class="p">:</span>
            <span class="n">closest</span> <span class="o">=</span> <span class="n">u</span>
            <span class="n">closest_dist</span> <span class="o">=</span> <span class="n">d</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The second thing is that a circle's shadow is the same no matter what your point of view is:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[49]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="mf">1.6</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">r</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">r</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.8</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The min is just the projected center minus the radius, and the max is just the projected center plus the radius.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Putting all of this together (and reusing a large part of the previous code):</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[50]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_separating_axis_polygon_and_circle</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns True and None if &quot;axis&quot; is a separating axis of v1 and a circle (v1 are vertices).</span>
<span class="sd">    Return False and the the translation vector otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">min1</span><span class="p">,</span> <span class="n">max1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;Inf&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v1</span><span class="p">:</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">min1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min1</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span>
        <span class="n">max1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max1</span><span class="p">,</span> <span class="n">proj</span><span class="p">)</span>

    <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="n">min2</span> <span class="o">=</span> <span class="n">proj</span> <span class="o">-</span> <span class="n">radius</span>
    <span class="n">max2</span> <span class="o">=</span> <span class="n">proj</span> <span class="o">+</span> <span class="n">radius</span>

    <span class="k">if</span> <span class="n">n1</span> <span class="o">&gt;=</span> <span class="n">m2</span> <span class="ow">and</span> <span class="n">n2</span> <span class="o">&gt;=</span> <span class="n">m1</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">n2</span> <span class="o">-</span> <span class="n">m1</span><span class="p">,</span> <span class="n">n1</span> <span class="o">-</span> <span class="n">m2</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="n">normalized</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span>
    
<span class="k">def</span> <span class="nf">polygon_vs_circle</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="n">circle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the minimum push vector of a polygon and a circle (None if they don&#39;t intersect).</span>
<span class="sd">    &quot;polygon&quot; and &quot;circle&quot; must be instances of ConvexPolygon and Circle respectively.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">closest</span><span class="p">,</span> <span class="n">closest_dist</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;Inf&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">v</span> <span class="o">-</span> <span class="n">circle</span><span class="o">.</span><span class="n">centroid</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">closest_dist</span><span class="p">:</span>
            <span class="n">closest</span> <span class="o">=</span> <span class="n">u</span>
            <span class="n">closest_dist</span> <span class="o">=</span> <span class="n">d</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">polygon</span><span class="o">.</span><span class="n">normals</span><span class="p">,</span> <span class="p">[</span><span class="n">normalized</span><span class="p">(</span><span class="n">closest</span><span class="p">)]),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">push_vectors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">separating</span><span class="p">,</span> <span class="n">tv</span> <span class="o">=</span> <span class="n">is_separating_axis_polygon_and_circle</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">polygon</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">circle</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">circle</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">separating</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span> <span class="c1"># The polygon and circle don&#39;t overlap if there exists at least one axis of separation</span>
        <span class="n">push_vectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tv</span><span class="p">)</span>

    <span class="n">mtv</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">push_vectors</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">centroid</span> <span class="o">-</span> <span class="n">polygon</span><span class="o">.</span><span class="n">centroid</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">mtv</span> <span class="o">=</span> <span class="o">-</span><span class="n">mtv</span>
    <span class="k">return</span> <span class="n">mtv</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<ul>
<li><em>Intersection testing methods in the demos are in</em> <code>data/scripts/hit.py</code>.</li>
</ul>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#sub_header Response 

<p>One way to handle response is just by moving the shapes directly. This is quite unnatural and very very buggy. If you launch <code>demo_collision.py</code> and uncheck <code>Impulse based resolution</code> from the side bar you can see how that looks. Since it's so bad I won't even try to make it work properly (sometimes shapes even fall through the floor).</p>
<p>We will instead use a more physical approach. For that, we will need a list of contact points - the points at which the objects (approximately) touched before intersecting.</p>

#sub_sub_header Collision Contact Points 

<p>In order to apply the impulse at the proper location, we need to calculate the points at which the collision happened. Generating good contact points is <em>crucial</em> to predictable and life-like iteractions between bodies.</p>


#sub_sub_sub_header Failed (?) first try

<p>At the beginning I thought about just projecting each vertex to the minimum translation vector and choosing the <em>two points with the largest projection</em> (the points that are the furthest "stuck" in the other body). If they are close together (by a given tolerance) though, the edge they form is almost perpendicular to the translation vector and we take their average (midpoint of the edge), otherwise we return the maximum point:</p>
<p><img src="data/contact-point.png" width = 760/></p>
<p>The implementation is really simple (after all I didn't put much thought into making an accurate algorithm :D):</p>
<div class="highlight"><pre><span></span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">)</span>
<span class="n">n1_v</span><span class="p">,</span> <span class="n">n2_v</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">shape</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
    <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">mta</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proj</span> <span class="o">&gt;</span> <span class="n">n2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">proj</span> <span class="o">&gt;=</span> <span class="n">n1</span><span class="p">:</span>
            <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">proj</span><span class="p">,</span> <span class="n">n1</span>
            <span class="n">n1_v</span><span class="p">,</span> <span class="n">n2_v</span> <span class="o">=</span> <span class="n">v</span><span class="p">,</span> <span class="n">n1_v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="n">proj</span>
            <span class="n">n2_v</span> <span class="o">=</span> <span class="n">v</span>
</pre></div>
<p>Here we project each vertex of a polygon to the <code>mta</code> (minimum translation axis) and calculate the two points with the largest projection.</p>
<div class="highlight"><pre><span></span><span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="k">if</span> <span class="n">n1</span> <span class="o">-</span> <span class="n">n2</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n1_v</span> <span class="o">+</span> <span class="n">n2_v</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">n1_v</span>
</pre></div>
<p>And at the end we return their "average".</p>
<p>The final code:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_average_contact_point</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">mta</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a very very crude approximation of the contact point of a shape when a collision occurs.</span>
<span class="sd">    It is used to calculate the angular velocity the shape recieves after the collision.</span>
<span class="sd">    Calculates the two vertices with the largest projection onto &quot;mta&quot; </span>
<span class="sd">    and returns the max or their average using some specified tolerance. </span>
<span class="sd">    For circles it returns the center (we don&#39;t even bother, you can&#39;t tell if they are rotating haha).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">sh</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">CIRCLE</span><span class="p">:</span> <span class="k">return</span> <span class="n">shape</span><span class="o">.</span><span class="n">centroid</span>

    <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">)</span>
    <span class="n">n1_v</span><span class="p">,</span> <span class="n">n2_v</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">shape</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">mta</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">proj</span> <span class="o">&gt;</span> <span class="n">n2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proj</span> <span class="o">&gt;=</span> <span class="n">n1</span><span class="p">:</span>
                <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">proj</span><span class="p">,</span> <span class="n">n1</span>
                <span class="n">n1_v</span><span class="p">,</span> <span class="n">n2_v</span> <span class="o">=</span> <span class="n">v</span><span class="p">,</span> <span class="n">n1_v</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n2</span> <span class="o">=</span> <span class="n">proj</span>
                <span class="n">n2_v</span> <span class="o">=</span> <span class="n">v</span>

    <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="k">if</span> <span class="n">n1</span> <span class="o">-</span> <span class="n">n2</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">n1_v</span> <span class="o">+</span> <span class="n">n2_v</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n1_v</span>
</pre></div>
<p>When we are doing circles we just return the centroid:</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">Circle</span><span class="p">):</span> <span class="k">return</span> <span class="n">shape</span><span class="o">.</span><span class="n">centroid</span>
</pre></div>
<p>This is because the way we have set it up it's impossible to tell if a circle is rotating :D (we don't draw any reference points). So this is a very big hack but since I thought this algorithm wouldn't be at all sufficient I didn't bother making it work for circles.</p>
<p>After writing it up with impulses and everything and testing it, the results were horrible (I even tried returning both points individually instead of taking the average but it was still too bad). I instantly concluded my algorithm was way too inaccurate.</p>

#sub_sub_sub_header The better method

<p>So now let's instead explore a popular way to calculate the contact points using the clipping method. The good thing is shares some parts with the algorithm above but it also introduces the concept of incident and reference edges.</p>
<p>The first step is to identify the two edges that are the most involved in the collision - we determine that by calculating which edge is most perpendicular to the collision normal.</p>
<p>We start by finding the farthest vertex in the shape. Then we look at the adjacent two edges:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[51]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">collision_find_best_edge</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mtv</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the edge furthest along &quot;mtv&quot; and most perpendicular to &quot;mtv&quot;.</span>
<span class="sd">    Also returns the furthest vurtex (we will need this later :P)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This part is familiar but instead of finding the two furthest vertices we find the one. </span>
    <span class="n">max_proj</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-Inf&quot;</span><span class="p">)</span>
    <span class="n">i_vertex</span><span class="p">,</span> <span class="n">vertex</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vertices</span><span class="p">):</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">proj</span> <span class="o">&gt;</span> <span class="n">max_proj</span><span class="p">:</span>
            <span class="n">i_vertex</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">vertex</span> <span class="o">=</span> <span class="n">v</span>
            <span class="n">max_proj</span> <span class="o">=</span> <span class="n">proj</span>
            
    <span class="c1"># Using the index of the furthest vertex we look at the adjacent edges</span>
    <span class="n">r_vertex</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[(</span><span class="n">i_vertex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)]</span>
    <span class="n">l_vertex</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[(</span><span class="n">i_vertex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)]</span>

    <span class="c1"># Both of these must point to &quot;vertex&quot;!</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">normalized</span><span class="p">(</span><span class="n">vertex</span> <span class="o">-</span> <span class="n">r_vertex</span><span class="p">)</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">normalized</span><span class="p">(</span><span class="n">vertex</span> <span class="o">-</span> <span class="n">l_vertex</span><span class="p">)</span>

    <span class="c1"># See which edge is &quot;more perpendicular&quot;. A dot product closer to 0 means angle closer to 90 degrees.</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">mtv</span><span class="p">):</span>
        <span class="c1"># Right edge is better</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">vertex</span><span class="p">,</span> <span class="n">r_vertex</span><span class="p">],</span> <span class="n">vertex</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Left edge is better</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">l_vertex</span><span class="p">,</span> <span class="n">vertex</span><span class="p">],</span> <span class="n">vertex</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Here's a visual test:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[52]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">poly1</span> <span class="o">=</span> <span class="n">ConvexPolygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span> <span class="o">-</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">recenter</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">poly2</span> <span class="o">=</span> <span class="n">ConvexPolygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">]]),</span> <span class="n">recenter</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">mtv</span> <span class="o">=</span> <span class="n">polygon_vs_polygon</span><span class="p">(</span><span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span><span class="p">)</span>
<span class="n">plot_vector</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">poly2</span><span class="o">.</span><span class="n">centroid</span> <span class="o">+</span> <span class="n">mtv</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">a_best_edge</span><span class="p">,</span> <span class="n">a_max_v</span> <span class="o">=</span> <span class="n">collision_find_best_edge</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span>
<span class="n">b_best_edge</span><span class="p">,</span> <span class="n">b_max_v</span> <span class="o">=</span> <span class="n">collision_find_best_edge</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="o">-</span><span class="n">mtv</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">a_best_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">a_best_edge</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">a_best_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">a_best_edge</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">b_best_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">b_best_edge</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">b_best_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">b_best_edge</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Now we choose the best of these edges as a "reference" edge and the other one will be the "incident" edge. We imagine as if the incident edge crashed into the reference edge, so the collision points will be along that.</p>
<div class="highlight"><pre><span></span><span class="n">a_best_edge</span><span class="p">,</span> <span class="n">a_max_v</span> <span class="o">=</span> <span class="n">collision_find_best_edge</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span>
<span class="n">b_best_edge</span><span class="p">,</span> <span class="n">b_max_v</span> <span class="o">=</span> <span class="n">collision_find_best_edge</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="o">-</span><span class="n">mtv</span><span class="p">)</span>

<span class="c1"># Now compare the dot products of the two best edges and determine ref/inc</span>
<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dot_edge</span><span class="p">(</span><span class="n">a_best_edge</span><span class="p">,</span> <span class="n">mtv</span><span class="p">))</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dot_edge</span><span class="p">(</span><span class="n">b_best_edge</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)):</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">a_best_edge</span>
    <span class="n">ref_max_v</span> <span class="o">=</span> <span class="n">a_max_v</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">b_best_edge</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">b_best_edge</span>
    <span class="n">ref_max_v</span> <span class="o">=</span> <span class="n">b_max_v</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">a_best_edge</span>
</pre></div>
<p>Again, we save the <code>ref_max_v</code> as the furthest vertex (we will use it as the final clip later).</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[53]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">dot_edge</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[54]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plot_vector</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">poly2</span><span class="o">.</span><span class="n">centroid</span> <span class="o">+</span> <span class="n">mtv</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">dot_edge</span><span class="p">(</span><span class="n">a_best_edge</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">dot_edge</span><span class="p">(</span><span class="n">b_best_edge</span><span class="p">,</span> <span class="n">mtv</span><span class="p">):</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">a_best_edge</span>
    <span class="n">ref_max_v</span> <span class="o">=</span> <span class="n">a_max_v</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">b_best_edge</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">b_best_edge</span>
    <span class="n">ref_max_v</span> <span class="o">=</span> <span class="n">b_max_v</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">a_best_edge</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">inc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">inc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">inc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">inc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>The reference edge is green and the incident edge is magenta.</p>
<p>Now we will take the end points of the incident edge as our collision points. We will clip them so they lie directly above the reference edge:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[55]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plot_vector</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">poly2</span><span class="o">.</span><span class="n">centroid</span> <span class="o">+</span> <span class="n">mtv</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">inc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">inc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">inc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">inc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>To actually clip the points, as you might guess if you think about the problem a bit, we will <em>again</em> use projections. Remember that the formula for the projection is:
$$ c_{\vec{p}}\vec{s} = \frac{\vec{s} \cdot \vec{v}}{|\vec{s}|^2} \vec{s} $$</p>
<p>But since we are comparing them, we don't need to be accurate. By that I mean we can safely ignore $|\vec{s}|^2$ and $\vec{s}$, since they are shared between all points we will be projecting (and $\vec{s}$ will be our vector defined from the reference edge).</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[56]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Since we are now dealing with contact points and we need to store a lot of information about them, we will make a class.</span>
<span class="c1"># This allows us to keep code readable and name certain properties instead of indexing into tuples.</span>
<span class="k">class</span> <span class="nc">Contact</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[57]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">collision_clip_segment</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">offset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clips the segment&#39;s end points if they are past &quot;offset&quot; along &quot;n&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">clipped</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> 
    <span class="n">d2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    
    <span class="c1"># If either point is past &quot;offset&quot; along &quot;n&quot; we keep it</span>
    <span class="k">if</span> <span class="n">d1</span> <span class="o">&lt;=</span> <span class="n">offset</span><span class="p">:</span>
        <span class="n">clipped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">d2</span> <span class="o">&lt;=</span> <span class="n">offset</span><span class="p">:</span>
        <span class="n">clipped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>

    <span class="n">d1</span> <span class="o">-=</span> <span class="n">offset</span>
    <span class="n">d2</span> <span class="o">-=</span> <span class="n">offset</span>
    
    <span class="c1"># Check if they are on opposing sides.</span>
    <span class="c1"># If you can visualize this in your head, if they are not on opposing sides, that means that</span>
    <span class="c1"># the segment is entirely outside of our view. In that case we return an empty array.</span>
    <span class="k">if</span> <span class="n">d1</span> <span class="o">*</span> <span class="n">d2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">p2</span> <span class="o">-</span> <span class="n">p1</span>
        <span class="c1"># Compute the coeff along &quot;e&quot;</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">/</span> <span class="p">(</span><span class="n">d1</span> <span class="o">-</span> <span class="n">d2</span><span class="p">)</span>
        <span class="c1"># The new position is &quot;u * e&quot; but we add the original point in order to convert it into the proper space</span>
        <span class="n">clipped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="n">u</span> <span class="o">+</span> <span class="n">p1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">clipped</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>We now need to do three clips in total. First, clip the end points against the first vertex of the reference edge, then against the second, and finally against the edge itself (disregard points that are not inside the other shape).</p>
<p>The first two clips use the method above:</p>
<div class="highlight"><pre><span></span><span class="n">ref_v</span> <span class="o">=</span> <span class="n">normalized</span><span class="p">(</span><span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">o1</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ref_v</span><span class="p">,</span> <span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">clipped</span> <span class="o">=</span> <span class="n">collision_clip_segment</span><span class="p">(</span><span class="n">inc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">ref_v</span><span class="p">,</span> <span class="n">o1</span><span class="p">)</span>

<span class="n">o2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ref_v</span><span class="p">,</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">clipped</span> <span class="o">=</span> <span class="n">collision_clip_segment</span><span class="p">(</span><span class="n">clipped</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clipped</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ref_v</span><span class="p">,</span> <span class="n">o2</span><span class="p">)</span>
</pre></div>
<p>The only thing we need to be careful is the signs here.</p>
<p>The third clip removes points that are above the reference edge - i.e they have a "negative" intersection (they are outside of the other shape). We project the points to <code>mtv</code> and compare them with the max vertex we saved earlier:</p>
<div class="highlight"><pre><span></span><span class="c1"># Clip the final points against the reference edge</span>
<span class="n">ref_max_v_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ref_normal</span><span class="p">,</span> <span class="n">ref_max_v</span><span class="p">)</span>

<span class="n">c0_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ref_normal</span><span class="p">,</span> <span class="n">clipped</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">ref_max_v_depth</span>
<span class="n">c1_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ref_normal</span><span class="p">,</span> <span class="n">clipped</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">ref_max_v_depth</span>

<span class="c1"># We also save the collision depth of each contact point.</span>
<span class="c1"># This is very important, because different contact points are in </span>
<span class="c1"># different depths and we need that information later</span>
<span class="n">contacts</span> <span class="o">=</span> <span class="p">[</span><span class="n">Contact</span><span class="p">(</span><span class="n">clipped</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">Contact</span><span class="p">(</span><span class="n">clipped</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">contacts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">collision_depth</span> <span class="o">=</span> <span class="n">c0_depth</span>
<span class="n">contacts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">collision_depth</span> <span class="o">=</span> <span class="n">c1_depth</span>

<span class="k">if</span> <span class="n">c1_depth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">contacts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">if</span> <span class="n">c0_depth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">contacts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs  ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[58]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">collision_clip_points</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">ref_max_v</span><span class="p">,</span> <span class="n">inc</span><span class="p">):</span>
    <span class="n">ref_v</span> <span class="o">=</span> <span class="n">normalized</span><span class="p">(</span><span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        
    <span class="n">o1</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ref_v</span><span class="p">,</span> <span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">clipped</span> <span class="o">=</span> <span class="n">collision_clip_segment</span><span class="p">(</span><span class="n">inc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">ref_v</span><span class="p">,</span> <span class="n">o1</span><span class="p">)</span>
    
    <span class="n">o2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ref_v</span><span class="p">,</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">clipped</span> <span class="o">=</span> <span class="n">collision_clip_segment</span><span class="p">(</span><span class="n">clipped</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clipped</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ref_v</span><span class="p">,</span> <span class="n">o2</span><span class="p">)</span>

    <span class="n">ref_normal</span> <span class="o">=</span> <span class="o">-</span><span class="n">orthogonal</span><span class="p">(</span><span class="n">ref_v</span><span class="p">)</span>
    <span class="n">ref_max_v_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ref_normal</span><span class="p">,</span> <span class="n">ref_max_v</span><span class="p">)</span>
    
    <span class="n">c0_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ref_normal</span><span class="p">,</span> <span class="n">clipped</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">ref_max_v_depth</span>
    <span class="n">c1_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ref_normal</span><span class="p">,</span> <span class="n">clipped</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">ref_max_v_depth</span>
    
    <span class="n">contacts</span> <span class="o">=</span> <span class="p">[</span><span class="n">Contact</span><span class="p">(</span><span class="n">clipped</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">Contact</span><span class="p">(</span><span class="n">clipped</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="n">contacts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">collision_depth</span> <span class="o">=</span> <span class="n">c0_depth</span>
    <span class="n">contacts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">collision_depth</span> <span class="o">=</span> <span class="n">c1_depth</span>
    
    <span class="k">if</span> <span class="n">c1_depth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">contacts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">c0_depth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">contacts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">contacts</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>Here is a test:</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell   ">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&nbsp;[59]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
     <div class="CodeMirror cm-s-jupyter">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_add_grid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>    

<span class="n">poly1</span> <span class="o">=</span> <span class="n">ConvexPolygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">recenter</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">poly2</span> <span class="o">=</span> <span class="n">ConvexPolygon</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.666</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.333</span><span class="p">]]),</span> <span class="n">recenter</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>

<span class="n">mtv</span> <span class="o">=</span> <span class="n">polygon_vs_polygon</span><span class="p">(</span><span class="n">poly1</span><span class="p">,</span> <span class="n">poly2</span><span class="p">)</span>

<span class="n">plot_polygon</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">plot_polygon</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plot_vector</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">centroid</span><span class="p">,</span> <span class="n">poly2</span><span class="o">.</span><span class="n">centroid</span> <span class="o">+</span> <span class="n">mtv</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">a_best_edge</span><span class="p">,</span> <span class="n">a_max_v</span> <span class="o">=</span> <span class="n">collision_find_best_edge</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span>
<span class="n">b_best_edge</span><span class="p">,</span> <span class="n">b_max_v</span> <span class="o">=</span> <span class="n">collision_find_best_edge</span><span class="p">(</span><span class="n">poly2</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="o">-</span><span class="n">mtv</span><span class="p">)</span>

<span class="k">if</span> <span class="n">dot_edge</span><span class="p">(</span><span class="n">a_best_edge</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">dot_edge</span><span class="p">(</span><span class="n">b_best_edge</span><span class="p">,</span> <span class="o">-</span><span class="n">mtv</span><span class="p">):</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">a_best_edge</span>
    <span class="n">ref_max_v</span> <span class="o">=</span> <span class="n">a_max_v</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">b_best_edge</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">b_best_edge</span>
    <span class="n">ref_max_v</span> <span class="o">=</span> <span class="n">b_max_v</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">a_best_edge</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">inc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">inc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">inc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">inc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">collision_clip_points</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">ref_max_v</span><span class="p">,</span> <span class="n">inc</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output ">
<img src="data:image/png;base64,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
"
class="
jp-needs-light-background
"
>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>You can play around with the coordinates and see where the contact points get placed.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#sub_sub_sub_header Quick word about circles

<p>Curved shapes are easy to handle! Just calculate the point furthest along the <code>mtv</code> by multiplying the normalized version by the radius. In that case we don't need to do any clipping, just bail out and return the point. Our final <code>collide</code> method with everything combined neatly looks like this:</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">collide</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of contact points or empty if &quot;a&quot; and &quot;b&quot; are not colliding.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">aabb_vs_aabb</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">aabb</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">aabb</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">mtv</span> <span class="o">=</span> <span class="n">minimum_translation_vector</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">transformed_shape</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">transformed_shape</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mtv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>      
        <span class="n">d</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">centroid</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">centroid</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mtv</span> <span class="o">=</span> <span class="o">-</span><span class="n">mtv</span>

        <span class="n">normal</span> <span class="o">=</span> <span class="n">normalized</span><span class="p">(</span><span class="n">mtv</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">shape</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">CIRCLE</span><span class="p">:</span>
            <span class="n">furthest_point</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">centroid</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">radius</span> <span class="o">*</span> <span class="n">normal</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">Contact</span><span class="p">(</span><span class="n">furthest_point</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">normal</span>
            <span class="n">c</span><span class="o">.</span><span class="n">collision_depth</span> <span class="o">=</span> <span class="n">magnitude</span><span class="p">(</span><span class="n">mtv</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="n">a_best_edge</span><span class="p">,</span> <span class="n">a_max_v</span> <span class="o">=</span> <span class="n">collision_find_best_edge</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">shape</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">CIRCLE</span><span class="p">:</span>
            <span class="n">furthest_point</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">centroid</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">radius</span> <span class="o">*</span> <span class="n">normal</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">Contact</span><span class="p">(</span><span class="n">furthest_point</span><span class="p">)</span>
            <span class="n">c</span><span class="o">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">normal</span>
            <span class="n">c</span><span class="o">.</span><span class="n">collision_depth</span> <span class="o">=</span> <span class="n">magnitude</span><span class="p">(</span><span class="n">mtv</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="n">b_best_edge</span><span class="p">,</span> <span class="n">b_max_v</span> <span class="o">=</span> <span class="n">collision_find_best_edge</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">transformed_shape</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="o">-</span><span class="n">mtv</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dot_edge</span><span class="p">(</span><span class="n">a_best_edge</span><span class="p">,</span> <span class="n">mtv</span><span class="p">))</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dot_edge</span><span class="p">(</span><span class="n">b_best_edge</span><span class="p">,</span> <span class="n">mtv</span><span class="p">)):</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">a_best_edge</span>
            <span class="n">ref_max_v</span> <span class="o">=</span> <span class="n">a_max_v</span>
            <span class="n">inc</span> <span class="o">=</span> <span class="n">b_best_edge</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">b_best_edge</span>
            <span class="n">ref_max_v</span> <span class="o">=</span> <span class="n">b_max_v</span>
            <span class="n">inc</span> <span class="o">=</span> <span class="n">a_best_edge</span>

        <span class="n">contacts</span> <span class="o">=</span> <span class="n">collision_clip_points</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">ref_max_v</span><span class="p">,</span> <span class="n">inc</span><span class="p">)</span>

        <span class="c1"># Don&#39;t forget the normals here...</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contacts</span><span class="p">:</span>
            <span class="n">c</span><span class="o">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">normal</span>
        <span class="k">return</span> <span class="n">contacts</span>
    <span class="k">return</span> <span class="p">[]</span>
</pre></div>
<p>We haven't taken a look at <code>minimum_translation_vector</code> but it's just a method which looks at the shapes and based on their type runs the algorithms for the #note_link[MTV] we described earlier!</p>
<p>Now we have all needed information!!! :D</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">


#sub_sub_header Impulse Based Collision Resolution 

<p>This is kinda the boring part, because this is just physics. We have the formulas and we need to write them in code. No problems to solve except if you got a minus wrong or some constant is messed up...</p>
<p>So the way we separate objects is by applying an impulse at every contact point. Impulse, remember, is an instantaneous change in velocity. Modifying acceleration or applying a force becomes too sloppy for the simulation.</p>
<p>First, we need to know the relative velocity at that contact point of the two objects (from A to B), which must be expressed in terms of the collision normal $\vec{n}$:
$$ \Delta \vec{V} \cdot \vec{n} = (\vec{V_{B}} + \omega \times \vec{r_{2}} - \vec{V_{A}} - \omega \times \vec{r_{1}}) \cdot \vec{n} $$</p>
<p>Omega here means the angular velocity and $\vec{r_{1}}$ and $\vec{r_{2}}$ are the vectors from the centers of the objects to the contact point.</p>
<p>The following formula relates the impulse with the masses and rotational intertias of the two objects:</p>
$$ k_n = \frac{1}{m_A} + \frac{1}{m_B} + \left[ \frac{1}{I_A}(\vec{r_1} \times \vec{n}) \times \vec{r_1} + \frac{1}{I_B}(\vec{r_2} \times \vec{n}) \times \vec{r_2} \right] \cdot \vec{n} $$<p>Due to floating point errors, if we implement these formulas exactly and run the simulation, our objects will be still going slowly downwards once they hit the static floor. This is because gravity causes error to accumulate and we just let it build up. To fix this, we will introduce a bias proportional to the magnitude of our mtv which we got from the intersection test earlier in order to correct the positions.</p>
$$ \text{bias} = \frac{\text{position_bias_factor}}{\Delta t} max(0, \text{allowed_penetration} - \text{collision_depth}) $$<p>We set $\text{position_bias_factor}$ as a constant to $0.2$ and $\text{allowed_penetration}$ to $0.01$ while $\text{collision_depth}$ is the depth of the current contact point.</p>
<p>$\Delta t$ is our time step in seconds. This means that the $\text{bias}$ is measured in $\frac{m}{s}$ and we can add it to the velocity directly.</p>
<p>Accounting for the bias, we get our impulse formula:</p>
$$ J = max(\frac{- \Delta \vec{V} \cdot \vec{n} + \text{bias}}{k_n}, 0) \cdot \vec{n} $$<p>We use <code>max</code> to ensure we don't get a negative impulse somehow.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>In code this looks like:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cross_scalar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="n">contacts</span> <span class="o">=</span> <span class="n">collide</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contacts</span><span class="p">:</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">pos</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">pos</span>

    <span class="n">rel_vel</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">vel</span> <span class="o">+</span> <span class="n">cross_scalar</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">ang_vel</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">vel</span> <span class="o">-</span> <span class="n">cross_scalar</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ang_vel</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>
    <span class="n">vel_along_normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rel_vel</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">normal</span><span class="p">)</span>

    <span class="n">rn1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">normal</span><span class="p">)</span>
    <span class="n">rn2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">normal</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">inv_mass</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">inv_mass</span>
    <span class="n">k</span> <span class="o">+=</span> <span class="n">a</span><span class="o">.</span><span class="n">inv_rot_inertia</span> <span class="o">*</span> <span class="p">(</span><span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span> <span class="o">-</span> <span class="n">rn1</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">inv_rot_inertia</span> <span class="o">*</span> <span class="p">(</span><span class="n">sqr_magnitude</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span> <span class="o">-</span> <span class="n">rn2</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">inv_k</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">k</span>

    <span class="n">bias</span> <span class="o">=</span> <span class="o">-</span><span class="n">position_bias_factor</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">dt</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">.</span><span class="n">collision_depth</span> <span class="o">+</span> <span class="n">allowed_penetration</span><span class="p">)</span>

    <span class="n">j</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">inv_k</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">vel_along_normal</span> <span class="o">+</span> <span class="n">bias</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">impulse</span> <span class="o">=</span> <span class="n">j</span> <span class="o">*</span> <span class="n">c</span><span class="o">.</span><span class="n">normal</span>
    <span class="n">apply_impulse</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="n">impulse</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span>
    <span class="n">apply_impulse</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">impulse</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span>
</pre></div>
<p>Here we use <code>inv_mass</code> (and <code>inv_rot_inertia</code>) which is pre-calculated (<code>1 / mass</code>) when we create a body. For static bodies <code>mass</code>, <code>inv_mass</code>, <code>rot_inertia</code>, and <code>inv_rot_inertia</code> are $0$ so we don't need an extra case for them here. The impulse they receive is automatically zero.</p>
<p>The demo is <code>demo_collision.py</code>.</p>

#sub_sub_header Iterations 

<p>You can increase the number of times you run the code and calculate and apply the impulse (this doesn't blow up because everytime you apply an impulse the relative velocity changes but we just don't move the objects yet). With each iteration we get closer to the true impulse (accuracy at the cost of performace). You can play with this in the demo in the side bar option.</p>


#sub_sub_header Friction 

<p>The shapes in the demo feel really slippery :D. That's because we don't simulate friction. If you want you can incorporate that into the engine by calculating the tangent normal for each contact point and applying a <em>friction impulse</em> using the friction coefficient for both bodies.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#sub_header Continuous Collision Detection 

<p>If you run <code>demo_tunneling.py</code> you will see a problem with our engine. Stuff that's moving fast can go through objects. This is not a bug in our code but instead a flaw in our <em>entire</em> design! It happens because we are calculating in <em>discrete</em> time steps.</p>
<p>That means that if a thing has a high enough velocity it can go straight through other objects and we can't possibly detect if the objects collided - they have already passed each other. You can increase the number of time steps but that comes with a <em>huge</em> cost of performance - you have to be a bit smarter.</p>
<p>There are methods to solve this. We #note[won't be implementing a continuous collision solver here](I actually really want to extend the demos and this article with an implementation, so stay tuned!) but there's a great talk by a #ext_link[Blizzard game developer at GDC](https://www.youtube.com/watch?v=7_nKOET6zwI) about a robust solution to this problem. There is also an #ext_link[article by Casey Muratori's blog](https://caseymuratori.com/blog_0003) on how to implement the GJK algorithm.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#header Practical Applications 

<p>So we've successfully looked at the beginning of an implementation of a physics engine. What do people use them for?</p>
<ul>
<li><p>Firstly, extending the thing we've built to 3D is not that hard actually. An extra coordinate everywhere doesn't change the idea of the math. After all, <em>linear algebra</em> works the same even with vectors of infinite dimension :P</p>
<p>One part becomes a lot harder though and that's rotations - in 3D we use <em>quaternions</em> (4D numbers) to represent orientations. It turns out that quaternions are the most robust and convenient way but also the most confusing and most rarely fully understood (just because we can't have an intuition for 4D objects). Nevertheless #ext_link[3blue1brown has a great series](https://www.youtube.com/watch?v=d4EgbgTm0Bg&ab_channel=3Blue1Brown) on a 3D perspective on visualizing quaternions.</p>
</li>
</ul>
<ul>
<li>Games often require a physics engine because of the gameplay elements in them that are supposed to represent real world objects. First person shooters for example rely on very accurate collision detection - or the players will get very frustrated. They also require a continuous collision solver because bullets move at very fast speeds. But some games are simpler in that aspect and get away with just a discrete physics solver.</li>
</ul>
<ul>
<li>Engineers use computer simulations to build aircraft, bridges, buildings, .. almost everything basically. It's super useful (and cheap) to test things in a simulation before building them in the real world.</li>
</ul>
<ul>
<li>Physicists and chemists use simulations to study the structure of molecules and predict how certain compounds would react with each other. Definitely one of the more interesting areas. </li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">
<p>I hope I've given you some basic understanding of how to implement a simulation yourself. I learned a whole bunch doing this project and I really enjoyed doing it and sharing the knowledge. Before this I've never been able to implement a working collision system.</p>
<p>I wrote the physics code in Python so it can be easily understood and ported to another language.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#header Further Reading 

<p>Here are a couple of links for more stuff related to simulating physics that's outside the scope of rigid body dynamics.</p>
<ul>
<li>Two Minute Papers, Training an AI to compute physics much faster than traditional methods: <a href="https://www.youtube.com/watch?v=atcKO15YVD8">https://www.youtube.com/watch?v=atcKO15YVD8</a></li>
</ul>
<ul>
<li>Why are cloth simulations difficult: <a href="https://www.youtube.com/watch?v=UoKXJzTYDpw&amp;vl=en">https://www.youtube.com/watch?v=UoKXJzTYDpw&amp;vl=en</a></li>
</ul>
<ul>
<li>A cellular automaton is a collection of particles on a grid of specified shape that evolves through a number of discrete time steps according to a set of rules based on the states of neighboring cells. Turns out you can use this to simulate sand gravity and pile-forming: <a href="https://core.ac.uk/download/pdf/82379543.pdf">https://core.ac.uk/download/pdf/82379543.pdf</a>. And here is a video: <a href="https://www.youtube.com/watch?v=AMm0gX9NXaI">https://www.youtube.com/watch?v=AMm0gX9NXaI</a></li>
</ul>
<ul>
<li>Lattice gas cellular automata (LGCA) on the other hand is a simulation where the dynamics of gas and fluids are simplied through simple local rules for the interactions between particles (cells): <a href="https://link.springer.com/referenceworkentry/10.1007%2F978-3-319-08234-9_184-1">https://link.springer.com/referenceworkentry/10.1007%2F978-3-319-08234-9_184-1</a>. An example: <a href="https://www.youtube.com/watch?v=odaJTL9_eCA">https://www.youtube.com/watch?v=odaJTL9_eCA</a></li>
</ul>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput " data-mime-type="text/markdown">

#author

#header Some References Which Made this Possible 

<ul>
<li>Arav Singhal, Making a 2D Physics Engine, 2018, #ext_link[link](https://www.codeproject.com/Articles/1214829/Making-a-D-Physics-Engine-Shapes-Worlds-and-Integr)</li>
<li>Erin Catto, Crystal Dynamics, Fast and Simple Physics using Sequential Impulses, 2006, #ext_link[link](https://github.com/erincatto/box2d-lite/blob/master/docs/GDC2006_Catto_Erin_PhysicsTutorial.pdf)</li>
<li>Gilles Bellot, The Centroid of Convex Polygons, 2019, #ext_link[link](https://bell0bytes.eu/centroid-convex/)</li>
<li>Randy Gaul, How to Create a Custom 2D Physics Engine: The Basics and Impulse Resolution, 2013, #ext_link[link](https://gamedevelopment.tutsplus.com/tutorials/how-to-create-a-custom-2d-physics-engine-the-basics-and-impulse-resolution--gamedev-6331)</li>
<li>Contact Points Using Clipping, 2011, #ext_link[link](http://www.dyn4j.org/2011/11/contact-points-using-clipping/)</li>
<li>Concise Tutorial for SAT (Separating Axis Theorem), 2017, #ext_link[link](https://hackmd.io/@US4ofdv7Sq2GRdxti381_A/ryFmIZrsl?type=view)</li>
<li>Orthogonal Projection onto a Line, #ext_link[link](https://en.wikibooks.org/wiki/Linear_Algebra/Orthogonal_Projection_Onto_a_Line)</li>
<li>YouTube, Mathispower4u, Proving the Vector Projection Formula, #ext_link[link](https://www.youtube.com/watch?v=MdfArHlKWZc)</li>
</ul>

</div>
</div>
</div>
</div>
</div>

